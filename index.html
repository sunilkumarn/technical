
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Scribblings</title>
  <meta name="author" content="Sunil Kumar">

  
  <meta name="description" content="To get started with what exactly is SSL pinning and why is this pretty important, please read this blog post. Just to summarize, A client when making &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tech.sunilnkumar.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Scribblings" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    >
  <header role="banner"><hgroup>
  <h1><a href="/">Scribblings</a></h1>
  
    <h2>Scribbling down experiences.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tech.sunilnkumar.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="http://www.sunilnkumar.com/">Home</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/08/22/ssl-pinning-with-rubymotion">SSL Pinning With Rubymotion</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-22T14:50:00+05:30" pubdate data-updated="true">Aug 22<span>nd</span>, 2014</time>
        
         | <a href="/2014/08/22/ssl-pinning-with-rubymotion#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>To get started with what exactly is SSL pinning and why is this pretty important, please read this <a href="http://blog.lumberlabs.com/2012/04/why-app-developers-should-care-about.html">blog post</a>.</p>

<p>Just to summarize,</p>

<p>A client when making an SSL connection to the server does not check whether the certificate is exactly the one that was uploaded to the server. In browsers, the connections are made to n number of hosts and is obviously unknown prior to making a connection whereas in case of a mobile app, thats not the case. The host to which the connection is to be made is known to the app development team ( certainly in most cases ). Hence we could utilize the power of SSL pinning in mobile apps to add the extra security layer.</p>

<p>To implement SSL pinning, you need the certificate within the app.
I use the BubbleWrap library to make http connections in RubyMotion, but this could well be implemented with something like AFMotion as well. BubbleWrap internally uses the NSUrlConnection to make requests. We use the delegate method of NSUrlConnection ( willSendRequestForAuthenticationChallenge ) to implement the pinning.</p>

<p>I monkey patch ( familiar to Rubyists ) **BubbleWrap::<a href="HTTP::Query**">HTTP::Query**</a> to make the necessary changes. Be sure to check that the file type of the certificate is &lsquo;der&rsquo; and its placed in the appropriate directory.</p>

<pre><code>class BubbleWrap::HTTP::Query
  def connection(connection, willSendRequestForAuthenticationChallenge: challenge)
    serverTrust = challenge.protectionSpace.serverTrust
    certificate = SecTrustGetCertificateAtIndex(serverTrust, 0)

    localCertData = (self.localCert)
    serverCertificateData = (SecCertificateCopyData(certificate))

    if(serverCertificateData.to_s == skabberCertData.to_s)
      credential = NSURLCredential.credentialForTrust(serverTrust)
      challenge.sender.useCredential(credential, forAuthenticationChallenge:challenge)
    else
      NSLog("The server's certificate does not match the servers. Cancelling the request.")
      challenge.sender.cancelAuthenticationChallenge(challenge)
    end
  end

  def localCert
    cerPath = NSBundle.mainBundle.pathForResource('something_domain_com', ofType:'der')
    (NSData.dataWithContentsOfFile(cerPath)).to_s
  end
end
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/03/28/tree-hierarchy-with-js-tree-and-ancestry">Tree Hierarchy With Js-tree and Ancestry</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-28T21:24:00+05:30" pubdate data-updated="true">Mar 28<span>th</span>, 2014</time>
        
         | <a href="/2014/03/28/tree-hierarchy-with-js-tree-and-ancestry#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently ended up reading one of my old codes where I had implemented a tree structure using the <a href="https://github.com/tristanm/jstree-rails">Js-tree</a> jquery library. Hadn&rsquo;t tried out the <a href="https://github.com/stefankroes/ancestry">ancestry</a> gem then. Decided to create such a tree structure using ancestry. Though it ended up pretty fast and simple, it for sure doesnt look as pretty as the one made with the js-tree library. Hence, decided to try out a combo of both and using old school recursion it worked out pretty well.</p>

<p>To get it working, assume you have a categories models with the has_ancestry method.</p>

<pre><code>Category.arrange_serializable.to_json
=&gt; [
        {
            "ancestry" =&gt; nil, "id" =&gt; 1, name: "OS",  "children" =&gt; [
                { "ancestry" =&gt; "1", "id" =&gt; 2, name: "Linux" "children" =&gt; [] }
            ]
        }
    ]
</code></pre>

<p>Now since we use the js-tree library to display the hierarchy, we need to do a minor hack here. Js-tree requires the &ldquo;data&rdquo; key and some meta info in the json data to display the content of the node in the view. With a handy recursive method, we acheieve this.</p>

<p>In the <em>models/categories.rb</em>, we do this</p>

<pre><code>class &lt;&lt; self
  def build_display_ancestry(category_hierarchy, tailored_hierarchy_data = [])
    category_hierarchy.each do |category_data|
      state = category_data['children'].empty? ? 'leaf' : 'open'
      custom_display_data = {
        :data =&gt; category_data['name'],
        :state =&gt; state,
        :metadata =&gt; { href: Rails.application.routes.url_helpers.category_path(category_data['id']) },
        :children =&gt;  build_display_ancestry(category_data['children'], [])
      }
      tailored_hierarchy_data &lt;&lt; custom_display_data
    end
    tailored_hierarchy_data
  end

  def viewed_ancestry
    build_display_ancestry(Category.arrange_serializable, [])
  end
end
</code></pre>

<p>The <em>categories_controller</em> would have a &lsquo;view_ancestry&rsquo; action for the js-tree method to fetch the data to be displayed,</p>

<pre><code>def view_ancestry
  render json: { data: 'Categories', state: 'open', metadata: { href: categories_path }, children: Category.viewed_ancestry }
end
</code></pre>

<p>Now, some javascript for fetching the info from the server and displaying the data on view,</p>

<pre><code>$(document).ready(function(){
$("#category-hierarchy").jstree({
    "json_data": {
        "ajax" : {
            "url" : $("#category-hierarchy").attr('data-path'),
            "data" : function (n) {
                return { id : n.attr ? n.attr("id") : 0 };
            }
        }
    },
    plugins : ["themes", "json_data", "ui"],
    themes : {"theme": "default", "icons":false, "dots": true, "open":true},
    core: {"animation": 100}
}).bind("select_node.jstree", function(e, data) {
        if (jQuery.data(data.rslt.obj[0], "href")) {
            window.location = jQuery.data(data.rslt.obj[0], "href");
        }
    })
});
</code></pre>

<p>Yes, you would need a &ldquo;#category-hierarchy&rdquo; div to display the data.</p>

<p>Once all done and set, you would get a pretty neat tree structure without much effort. Something that looks like this,</p>

<div>
 <img src = "/images/tree-hierarchy.png" alt = "Hierarchy">
</div>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/03/25/rubymotion-push-notifications">Rubymotion: Push Notifications</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-25T16:24:00+05:30" pubdate data-updated="true">Mar 25<span>th</span>, 2014</time>
        
         | <a href="/2014/03/25/rubymotion-push-notifications#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>To setup the app id and ssl certificate and download the ios provisioning profile for push notifications in development mode, this would be a great <a href="http://www.raywenderlich.com/32960/apple-push-notification-services-in-ios-6-tutorial-part-1">article</a> to read on. It worked like a charm for me.</p>

<p>Once thats been done, in your Rubymotion project, add a few extra lines in the Rakefile.</p>

<pre><code>app.name = 'Myapp'
app.identifier = 'com.myapp.development'
app.provisioning_profile = '.environments/Myapp_Develpoment.mobileprovision'
app.entitlements['keychain-access-groups'] = [
  app.seed_id + '.' + app.identifier
]
app.entitlements['aps-environment'] = 'development'
app.entitlements['get-task-allow'] = true
</code></pre>

<p>The <em>app.identifier</em> needs to be the same as the identifier of the app id which was created in the ios development portal.
<em>Myapp_Develpoment.mobileprovision</em> is the provisioning profile generated and downloaded for the app id with identifier &lsquo;com.myapp.development&rsquo;. Both of them are extremely important for the push notifications to work.</p>

<p>In app_delegate.rb, do this.</p>

<pre><code>def application(application, didFinishLaunchingWithOptions:launchOptions)
  ...
  UIApplication.sharedApplication.registerForRemoteNotificationTypes(UIRemoteNotificationTypeAlert | UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound)
  true
end

def application(application, didRegisterForRemoteNotificationsWithDeviceToken: device_token)
  NSLog("My token is: %@", device_token)
end

def application(application, didFailToRegisterForRemoteNotificationsWithError: error)
  NSLog(error.inspect)
end
</code></pre>

<p>Next time, when the app is installed on the device it receives an alert requesting permissions to enable push notifications. Also note that the app would ask for permissions only on first time installation. To simulate a first time installation of the app do the following:</p>

<ul>
<li>uninstall the app from the device</li>
<li>switch off &amp; on the device</li>
<li>reset the date to 2 days ahead</li>
<li>switch off and on again</li>
<li>reset the date to even 2 days ahead</li>
<li>switch it off &amp; on for a last time.</li>
</ul>


<p>Install the app and the alert requesting the permission should appear now. ( Got this through some pretty ordinary googling, but it worked pretty well for me :) )</p>

<p>Note down the device_token received in <em>didRegisterForRemoteNotificationsWithDeviceToken</em> method. This is almost like the address of the device to which the push notifications will be sent from the APNS server.</p>

<p>To send a push notification from a Ruby app, I used the grocer gem which worked pretty neat and fast for me. Install the gem &amp; do the following.</p>

<pre><code>require 'grocer'

pusher = Grocer.pusher(
  :certificate =&gt; "ck.pem",
  :passphrase =&gt;  "passphrase",
  :retries =&gt; 3
)

notification = Grocer::Notification.new(
  :device_token  =&gt;   " device token ",
  :alert =&gt;  "My first notification",
  :badge =&gt;   0
)

pusher.push(notification)
</code></pre>

<p>If nothing has been done on the app side to handle these notifications, close the app and send the notifications. They should appear on screen now.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/02/27/objective-c-categories-into-rubymotion">Objective-C Categories Into Rubymotion</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-27T14:04:00+05:30" pubdate data-updated="true">Feb 27<span>th</span>, 2014</time>
        
         | <a href="/2014/02/27/objective-c-categories-into-rubymotion#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>People familiar with developing Ios applications with Objective-C would be quite familiar with using <strong>categories</strong> I suppose.</p>

<p>An Objective-C category allows you to add methods to an existing class — effectively subclassing it without having to deal with the possible complexities of subclassing.</p>

<p>Moving into Rubymotion and using the power of categories is quite well possible for people who have been working with Ruby. <strong>Monkey Patching</strong> ( open an existing class and add your custom code within it ) it quite a familiar task with Rubyists.</p>

<p>Below is an example where I need to add a customized back button for the UINavigationController navigation bar. I need this to be the back button in quite a few View controllers. It would be quite a tedious task to create a button in each VC, hence I create a category file and monkey patch the UIBarButtonItem class to add a new method which returns the customized back button.</p>

<p><em>app/categories/ui_bar_button_item.rb</em></p>

<pre><code>def self.customBackButton(target, action)
  buttonImage = UIImage.imageNamed('arrow.jpeg')
  button = UIButton.buttonWithType(UIButtonTypeCustom)
  button.setImage(buttonImage, forState:UIControlStateNormal)
  button.frame = CGRectMake(0, 0, buttonImage.size.width, buttonImage.size.height)
  button.addTarget(target, action:action, forControlEvents:UIControlEventTouchUpInside)
  customBarItem = UIBarButtonItem.alloc.initWithCustomView(button)
  customBarItem
end
</code></pre>

<p>The view controller which needs to have this customized back button will have this</p>

<pre><code>def viewDidAppear(animated)
  super
  self.navigationItem.leftBarButtonItem = UIBarButtonItem.customBackButton(self.navigationController, 'popViewControllerAnimated:')
end
</code></pre>

<p>This would use Ruby&rsquo;s monkey patching power to create elements in Rubymotion which could be used in the entire application as &amp; when needed.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/02/06/rubymotion-chain-of-modal-segues">Rubymotion: Chain of Modal Segues</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-06T19:02:00+05:30" pubdate data-updated="true">Feb 6<span>th</span>, 2014</time>
        
         | <a href="/2014/02/06/rubymotion-chain-of-modal-segues#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While building my iOS application, I had a user registration process to be implemented. This included the user entering his mobile number, his language details and a few other ( say, miscellaneous ) details. Once he has registered himself he is presented with a table view where a few movies in the language he chose are shown.</p>

<p>The way I went about implementing is that I had a <strong>master_view_controller</strong> which is the initial view controller. The other controllers are</p>

<ul>
<li><strong>mobile_number_view_controller</strong></li>
<li><strong>language_view_controller</strong></li>
<li><strong>miscellaneous_view_controller</strong></li>
<li><strong>movies_view_controller</strong></li>
</ul>


<p>I have segues, <strong>all of type modal</strong>, from the master controller to all other controllers I mentioned above. The segues are of modal type because once the user has submitted each of his details, he doesnt have to care about the particluar detail and is given no option to go back to his previous screen. Its not a like a dig deep type of chain where we could implement the navigation controller. The segues are the follows.</p>

<p>On the left we have the contoller and on the right we have the segue identifier to that controller from the master controller.</p>

<pre><code>master_view_controller:
  mobile_number_view_controller -&gt; msisdnSegue
  language_view_controller -&gt; languageSegue
  miscellaneous_view_controller -&gt; miscellaneousSegue
  movies_view_controller -&gt; moviesSegue
</code></pre>

<p>Also, we have this chain of modal segues.</p>

<pre><code>master_view_controller -&gt; mobile_number_view_controller -&gt; language_view_controller -&gt; miscellaneous_view_controller
</code></pre>

<p>Now in the viewDidAppear delegate of the master controller, we have this check to present the appropriate controller. The details entered by the user in the registration process are saved( we use <strong>motion model</strong> to store the details of the user ). Ofcourse, we dont want a user who has entered his mobile number once to enter it again even if he has opted to quit the app after entering the mobile number. Similarly we dont want him to select his language for the second time during the registration process. We consider all this in the viewDidAppear delegate and decide which contoller to load.</p>

<p>master_view_controller.rb ( This obviously can be implemented better :) )</p>

<pre><code>def viewDidAppear(animated)
  super
  perform_criteria_based_segue
end

def perform_criteria_based_segue
  @user = User.first

  if (not @user) or (not @user.verified_mobile_number)
    performSegueWithIdentifier('msisdnSegue', sender: self)
  end

  elsif not @user.language
    performSegueWithIdentifier('languageSegue', sender: self)
  end

  elsif not @user.miscellaneous_details
    performSegueWithIdentifier('miscellaneousSegue', sender: self)
  end

  else
    performSegueWithIdentifier('moviesSegue', sender: self)
  end
end
</code></pre>

<p>Now, suppose the user reached the view where he has to enter his misellaneous details. Once he entered them all he now has to be be shown the table view which list the movies in his language. We have implemented this segue to the movies_view_controller in <strong>viewDidAppear</strong> delegate in the <strong>master_view_controller</strong>. Hence for this to work, the master_view_controller&rsquo;s view will have to appear. For this to happen, the current controller( the i.e, <strong>miscellaneous_view_controller</strong> ) along with all controllers in between the current controller and the master view controller will have to be dismissed ( in our case, its only the <strong>language_view_controller</strong> ).</p>

<p>For this to be done, we have the <strong>dismissViewControllerAnimated(flag, completion:completion_block)</strong> method.</p>

<p>We implement this method in the presented view controller. Here, <strong>miscellaneous_view_controller</strong> is the current presented view controller.</p>

<p>miscellaneous_view_controller.rb</p>

<pre><code>outlet :submitButton, UIButton
ib_action :submit_miscellanous_details

def submit_miscellanous_details
  # Do something here...

  self.view.window.rootViewController.dismissViewControllerAnimated(true, completion:nil)
end
</code></pre>

<p>So in the <strong>miscellaneous_view_controller</strong> controller we have a <em>submitButton</em> which is tied to an ib_action <em>submit_miscellanous_details</em>. On submitting the button, the ib_action is invoked. We do whatever necessary steps is required in the ib_action and then <strong>invoke dismissViewControllerAnimated on the rootViewController( i.e, the master_view_controller )</strong>. When this is done, the presented controllers and all other controllers in the chain of controllers until the presenting controller on whom the dismissViewControllerAnimated method is called ( here, the rootViewController) is also dismissed. The rootViewController or the master_view_controller view appears on screen and the viewDiDAppear delegate will process the rest.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/01/24/rubymotion-using-progresshud-while-making-http-calls">Rubymotion: Using ProgressHud While Making Http Calls</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-24T20:04:00+05:30" pubdate data-updated="true">Jan 24<span>th</span>, 2014</time>
        
         | <a href="/2014/01/24/rubymotion-using-progresshud-while-making-http-calls#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>With Rubymotion, there are quite a few methods to indicate activities. What I have used here is the MBProgressBarHud to indicate an ongoing activity ( an http call in progress )</p>

<h4>controller/msisdn_view_controller.rb</h4>

<pre><code>outlet :submitButton, UIButton
ib_action :submit_mobile_number  #The submit button on event ‘Touch Up Inside’ invokes the action submit_mobile_number

def viewDidLoad
  @hud = MBProgressHUD.alloc.initWithWindow(UIApplication.sharedApplication.keyWindow)
  self.view.addSubview(@hud)
end

def submit_mobile_number(sender)
  msisdn = self.msisdnTextField.text
  prepare_for_submission
  User.registration msisdn, do
    after_submission
  end
end

def prepare_for_submission
  @hud.labelText = "Provisioning"
  @hud.show(true)
  self.view.userInteractionEnabled = false
end

def after_submission
  @hud.labelText = "Completed";
  @hud.hide(true)
  performSegueWithIdentifier('submission_segue', sender: self)
end
</code></pre>

<h4>models/user.rb</h4>

<pre><code>def self.registration(msisdn, &amp;callback)
  ...
  url = 'some_url'
  BW::HTTP.get(url) do |response|
    callback.call
    ...
  end
end
</code></pre>

<p>As you could see from the code above, in the viewDidLoad delegate we initiate an MBProgressHUD instance and add it as a subview to the UIView. This is done in the viewDidLoad delegate.</p>

<p>Before the call to <strong>registration</strong> ( the User model method which makes an http connection ) is made, the <strong>prepare_for_submission</strong> method displays the hud. The <strong>after_submission</strong> method is passed as a callback block to the <strong>registration</strong> method. On completion of the http request, this block is executed which hides the hud and performs the segue to present the next controller.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/12/18/heroku-deployment-with-mongodb-database">Heroku Deployment With MongoDB Database</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-18T19:01:00+05:30" pubdate data-updated="true">Dec 18<span>th</span>, 2013</time>
        
         | <a href="/2013/12/18/heroku-deployment-with-mongodb-database#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Currently, I develop a Rails app with <a href="http://www.mongodb.org/">mongodb</a> as the database.
When I decided to deploy this in heroku, as per the heroku dev doc, I was asked to simply install the MongoHQ Add-on, and specify the plan that I desire.</p>

<p>So, supposedly all I had to do was this,</p>

<div>
  <pre><code class='bash'>heroku addons:add mongohq:small</code></pre>
</div>


<p>and I would have the MONGOHQ_URL to add to the mongoid configuration ( config/mongoid.yml ).
But unfortunately, this would ask me to verify my heroku account</p>

<div>
  <pre><code class='bash'>Adding mongolab on chillrapi... failed
 !    Please verify your account to install this add-on
 !    For more information, see http://devcenter.heroku.com/categories/billing
 !    Verify now at https://heroku.com/verify</code></pre>
</div>


<p>Clicking on the verification link asks for my credit card details. Now, its mentioned that mongohq-small is a free version of the add on. So you could probably carry on providing your details. For the others, you may please read on.</p>

<p>MongoHQ is a cloud-based hosted database solution that allows developers to easily deploy, manage and scale both single and replica set MongoDB databases for their web and mobile applications.</p>

<p>I created a new database (SandBox, 512 MB &ndash;  thats all I needed anyways ) at MongoHQ.
On creating a new database, MongoHQ provides us with a mongo console and mongo uri connection strings.</p>

<p><strong>Mongo Console</strong></p>

<div>
  <pre><code class='bash'>mongo paulo.mongohq.com:10097/chillr_db -u &lt;user&gt; -p&lt;password&gt;</code></pre>
</div>


<p><strong>Mongo URI</strong></p>

<div>
  <pre><code class='bash'>mongodb://&lt;user&gt;:&lt;password&gt;@paulo.mongohq.com:10097/chillr_db</code></pre>
</div>


<p>Now, add a database user with a username, password. Check <a href="http://support.mongohq.com/common-questions/debugging-connection-issues.html">mongohq support docs</a> for reference.</p>

<p>You could try out the mongo console connection string from your local to check if the user credentials are valid. Once you find them valid, add the MONGOHQ_URL to the heroku config set.</p>

<div>
  <pre><code class='bash'>heroku config:set MONGOHQ_URL=&quot;mongodb://&lt;user&gt;:&lt;password&gt;@paulo.mongohq.com:10097/chillr_db&quot;</code></pre>
</div>


<p>Be sure to replace the username and password while adding.
Thats it, Mongodb hosted in MongoHQ should be now available for use in the application.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/09/01/migrating-from-wordpress-to-jekyll-in-ten-steps">Migrating From Wordpress to Jekyll in Ten Steps</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-01T13:32:26+05:30" pubdate data-updated="true">Sep 1<span>st</span>, 2013</time>
        
         | <a href="/2013/09/01/migrating-from-wordpress-to-jekyll-in-ten-steps#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Migrating from Wordpress to <a href="http://jekyllrb.com/">Jekyll</a> is not at all a fussy process. Here, I will state down the 10 steps on how I moved my blog from Wordpress to github pages using jekyll.  It would be really good if you could just have a walk through jekyll&rsquo;s home pages to get an idea of the prerequisities and workings.</p>

<p>1) Export your blog from Wordpress and download the exported xml thats generated by Wordpress. Use xmllint for xml validation and correct any errors that might be there.</p>

<p>2) Jekyll provides with enough options to migrate from a different blogging system. What I used for the process was the tool, <a href="https://github.com/thomasf/exitwp">exitwp</a> by <a href="http://thomas.jossystem.se/">thomasf</a>. Followed the instructions in the README and this worked like a charm .</p>

<p>  If followed properly, the &lsquo;build&rsquo; directory will have the posts converted into markdown format which is required by jekyll.</p>

<p>3) Install the jekyll gem,</p>

<div>
  <pre><code class='bash'>$: gem install jekyll</code></pre>
</div>


<p>4) Now initialize your new blog</p>

<div>
  <pre><code class='bash'>$: jekyll new techblog</code></pre>
</div>


<p>cd into the techblog directory and you could see the directory structure there.</p>

<div>
  <pre><code class='bash'>_posts
_layouts
css
_config.yml
index.html</code></pre>
</div>


<p>This is the minimum directory structure that jenkyll requires inorder to work as a fully functional website. How cool, right?
Now all you need is to copy all the posts from the <code>&lsquo;build/jekyll/username.wordpress.com/<em>posts&rsquo;</code> directory of the exitwp tool to the </em>posts directory of your new &lsquo;techblog&rsquo;. Also you may want to add your own configurations in the config file (specially, the <a href="http://jekyllrb.com/docs/permalinks/">permalink</a> option)</p>

<p>5) Once you have done this, its time to view the website in our local machine. To do this run,</p>

<div>
  <pre><code class='bash'>$: jekyll serve -w   # -w, watch so that your changes are automatically reloaded</code></pre>
</div>


<p><code> <a href="http://localhost:4000">http://localhost:4000</a> </code> and you could view your minimalistic static website.</p>

<p>6) Now to host your website on <a href="http://pages.github.com/">github pages</a>, there are some special rules to be followed. The repo you create in github must be of the name, <strong>username.github.io</strong> and there fore in my case it was sunilkumarn.github.io . Create this repo in your github account and set the giturl in your local &lsquo;techblog&rsquo; directory.</p>

<p>7) Push your commits to github.</p>

<p>8) Check your mail to see if there are any build failure mails from github. If no, all is hunky dorry. Wait for something like 5 -10 minutes and type <code>&lsquo;<a href="http://username.github.io">http://username.github.io</a>&rsquo;</code> in your browser. You should see your website, Yeeyy!</p>

<p>9) To point a domain to your website, check <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-pages">github pages help</a>. For me, I pointed a subdomain to my new blog.</p>

<ul>

<li>Github pages will mention the IP hosted. Point the A record of your domain to the mentioned IP from your domain registrar.</li>

<li>Also, add a new file CNAME to the root of your &#8216;techblog&#8217; directory. The file has a line containing your domain name, thats it.</li>
    eg, tech.sunilnkumar.com
</ul>


<p>10) Push your changes to github and wait for some time (cannot provide a good estimate). Your domain will be pointed to your new website hosted on github pages via jekyll. Also please do not forget to check if issues like broken urls, formatting issues, code highlightings etc etc exists. If yes, you might need to invest a bit more of your time to fix these as I had to.</p>

<p>The source of my website can be found <a href="https://github.com/sunilkumarn/sunilkumarn.github.io">here</a></p>

<p>Happy migrating :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/07/07/node-js-event-emitters-and-listeners">Node.js: Event Emitters and Listeners</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-07T13:32:26+05:30" pubdate data-updated="true">Jul 7<span>th</span>, 2013</time>
        
         | <a href="/2013/07/07/node-js-event-emitters-and-listeners#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When building client side applications with Javascript, events and handling them are quite common. Consider, for example,</p>

<div>
  <pre><code class='javascript'>$(&#39;#toBeClicked&#39;).on(&#39;click&#39;, function() { alert(&#39;clicked&#39;) })</code></pre>
</div>


<p>Here we handle a <em>click event</em> on the element with id &lsquo;toBeClicked&rsquo;. When the element is clicked, a &lsquo;click&rsquo; event is emitted which is handled by the above statement written by us.</p>

<p>Just like in the DOM,  many objects in node emit events. When they do so, they inherit from the <strong>EventEmitter</strong> constructor.</p>

<p>Lets straight away build a custom event emitter and see whats going on,</p>

<div>
  <pre><code class='javascript'>EventEmitter = require(&#39;events&#39;).EventEmitter       // The Event Emitter constructor in the events.js module .</code></pre>
</div>


<p>Now, we create our custom emitter which is an instance of EventEmitter,</p>

<div>
  <pre><code class='javascript'>emitter = new EventEmitter();</code></pre>
</div>


<p>We listen for the error event,</p>

<div>
  <pre><code class='javascript'>emitter.on(&#39;error&#39;, function(msg1, msg2) { console.log(&#39;ERR: &#39; + msg1 + &#39; &#39; + msg2 ) })</code></pre>
</div>


<p>Here, <code>function(msg1, msg2) { console.log('ERR' + msg1 + ' ' + msg2 ) }</code></p>

<p>is the callback to be performed once the event is emitted,</p>

<p>We could also listen as,</p>

<div>
  <pre><code class='javascript'>emitter.addListener(&#39;error&#39;, function(msg1, msg2) { console.log(&#39;ERR: &#39; + msg1 + &#39; &#39; + msg2 ) } )</code></pre>
</div>


<p>Now we emit the error event,</p>

<div>
  <pre><code class='javascript'>emitter.emit(&#39;error&#39;, &#39;Bug detected&#39;, &#39;@ Step 4&#39;)</code></pre>
</div>


<p>Once the &lsquo;error&rsquo; event is emitted, the listener performs the callback and we see the error logged in the console(as we have written in the callback function)
<code>ERR: Bug detected @ Step 4</code></p>

<p>We could add listeners on any more custom events and handle them when the event is emitted.</p>

<p>Now that we have got to know how events are emitted and handled via listeners, lets try out a small server that listens for requests and processes them.</p>

<div>
  <pre><code class='javascript'>var http = require(&#39;http&#39;),
    sys = require(&#39;sys&#39;);

var server = http.createServer(function(request, response) {
  request.on(&#39;data&#39;, function (chunk) { console.log(chunk.toString()); });

  request.on(&#39;end&#39;, function() {
    response.write(&#39;Request Completed!&#39;);
    response.end();
  });

});

console.log(&quot;Starting up the server&quot;);
server.listen(8000);</code></pre>
</div>


<p>Here, <code>http.createServer</code> method returns an object which inherits from the EventEmitter constructor.</p>

<p>Check out the <a href="http://nodejs.org/api/http.html#http_http_createserver_requestlistener">nodejs api doc</a> for the createServer method in the<strong> http.js</strong> module,</p>

<p><code>http.createServer([requestListener]), </code><em>It says that requestListener is a function which is automatically added to the &lsquo;request&rsquo; event.</em></p>

<p>To check whats going on behind the scenes here, lets dive into the code base of nodejs,
As can be seen from code, the createServer method is within the http.js module. Inspecting the <strong>http.js</strong> module,</p>

<div>
  <pre><code class='javascript'>exports.createServer = function(requestListener) {
  return new Server(requestListener);
};</code></pre>
</div>


<p>Check for the <strong>_http_server.js</strong> module to find the <code>Server</code> constructor which has the following lines of code,</p>

<div>
  <pre><code class='javascript'>if (requestListener) {
  this.addListener(&#39;request&#39;, requestListener); // event listener for the server
}</code></pre>
</div>


<p>As per the above snippet, &lsquo;<strong>this</strong>&rsquo;(the current server instance ) listens for the &lsquo;request&rsquo; event and attaches the requestListener function to be performed when the event is emitted.</p>

<p>Here,</p>

<div>
  <pre><code class='javascript'>function(request, response) {
  request.on(&#39;data&#39;, function (chunk) { console.log(chunk.toString()); });

  request.on(&#39;end&#39;, function() {
    response.write(&#39;Request Completed!&#39;);
    response.end();
  });
}</code></pre>
</div>


<p><em>is our requestListener.</em></p>

<p>Now, further inspecting the <strong>_http_server.js </strong>module<strong>, </strong>we could also see how the request event is emitted,</p>

<div>
  <pre><code class='javascript'>self.emit(&#39;request&#39;, req, res); // event emitter for the server</code></pre>
</div>


<p><em>&lsquo;req&rsquo; and &lsquo;res&rsquo; are the request, response objects that are passed as arguments to the requestListener function called when the &lsquo;request&rsquo; event is emitted. Here self is &lsquo;this&rsquo; ( our current server instance)</em>.</p>

<p>We could well make the server listen for the request event on our own. For this,</p>

<div>
  <pre><code class='javascript'>var server = http.createServer()
server.on(&#39;request&#39;, function(request, response) {
  request.on(&#39;data&#39;, function (chunk) { console.log(chunk.toString()); });

  request.on(&#39;end&#39;, function() {
    response.write(&#39;Request Completed!&#39;);
    response.end();
  })
});</code></pre>
</div>


<p>Here when we create the server instance, we do not pass the requestListener( <em>Do notice that requestListener was only optional in http.createServer([requestListener]) </em>). Instead we attach a listener of our own on the server which listens to the &lsquo;request&rsquo; event and performs the callback function when the request event is emitted, i.e,</p>

<div>
  <pre><code class='javascript'>server.on(&#39;request&#39;, function(request, response) { ... });</code></pre>
</div>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/07/06/rails-admin-with-authlogic">Rails Admin With Authlogic</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-06T23:13:31+05:30" pubdate data-updated="true">Jul 6<span>th</span>, 2013</time>
        
         | <a href="/2013/07/06/rails-admin-with-authlogic#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you have used the rails_admin gem, you would have noticed that its tightly coupled with Devise. What happens if devise is not the pick and the application is already integrated with authlogic. Lets see,</p>

<p>After installing the rails_admin gem, create a &lsquo;<strong>rails_admin.rb</strong>&rsquo; file in <strong>config/initializers</strong>. Paste the following code,</p>

<div>
  <pre><code class='ruby'>RailsAdmin.config do |config|
    config.authorize_with do
      redirect_to root_path, :alert =&gt; &quot;You are not authorized!&quot; unless current_user.admin?
    end
  end

  RailsAdmin.config do |config|
    config.authenticate_with do
      unless current_user
        redirect_to login_url
      end
    end
  end</code></pre>
</div>


<p>The authentication block checks if the user is currently logged in and the authorization block checks if the logged in user is an admin or not.</p>

<p>Also add the rails admin route in the <strong>config/routes.rb</strong> file.</p>

<div>
  <pre><code class='ruby'>mount RailsAdmin::Engine =&gt; &#39;/admin&#39;, :as =&gt; &#39;rails_admin&#39;</code></pre>
</div>


<p>This should enable the admin to run at /admin, now authenticated and authorized using authlogic.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/08/22/ssl-pinning-with-rubymotion">SSL Pinning With Rubymotion</a>
      </li>
    
      <li class="post">
        <a href="/2014/03/28/tree-hierarchy-with-js-tree-and-ancestry">Tree Hierarchy With Js-tree and Ancestry</a>
      </li>
    
      <li class="post">
        <a href="/2014/03/25/rubymotion-push-notifications">Rubymotion: Push Notifications</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/27/objective-c-categories-into-rubymotion">Objective-C Categories Into Rubymotion</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/06/rubymotion-chain-of-modal-segues">Rubymotion: Chain of Modal Segues</a>
      </li>
    
      <li class="post">
        <a href="/2014/01/24/rubymotion-using-progresshud-while-making-http-calls">Rubymotion: Using ProgressHud While Making Http Calls</a>
      </li>
    
      <li class="post">
        <a href="/2013/12/18/heroku-deployment-with-mongodb-database">Heroku Deployment With MongoDB Database</a>
      </li>
    
      <li class="post">
        <a href="/2013/09/01/migrating-from-wordpress-to-jekyll-in-ten-steps">Migrating From Wordpress to Jekyll in Ten Steps</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/07/node-js-event-emitters-and-listeners">Node.js: Event Emitters and Listeners</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/06/rails-admin-with-authlogic">Rails Admin With Authlogic</a>
      </li>
    
  </ul>
</section>




<section class="googleplus">

<h1>
  <a href="http://github.com/sunilkumarn/"><img src="http://i835.photobucket.com/albums/zz277/sunilkumargec56/github_zpse87fc53d.jpg" width="40" height="40"></a>
  &nbsp; &nbsp;
  <a href="http://twitter.com/sunilkumar_g56"><img src="http://i835.photobucket.com/albums/zz277/sunilkumargec56/twitter_zps447bd274.jpg" width="40" height="40"></a>
</h1>

</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Sunil Kumar -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'techscribblings';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44991607-1', 'sunilnkumar.com');
    ga('send', 'pageview');
  </script>
</body>

</html>
