
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Scribblings</title>
  <meta name="author" content="Sunil Kumar">

  
  <meta name="description" content="Consider you have a module and a class. module Mymod and a class Myclass. The situation in hand is such that certain functions in the module need to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sunilkumarn.github.io/technical/blog/page/2">
  <link href="/technical/favicon.png" rel="icon">
  <link href="/technical/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/github/atom.xml" rel="alternate" title="Scribblings" type="application/atom+xml">
  <script src="/technical/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/technical/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/technical/">Scribblings</a></h1>
  
    <h2>scribbling down experiences</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/github/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sunilkumarn.github.io/technical" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/technical/">Blog</a></li>
  <li><a href="/technical/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2011/07/04/module-functions-as-class-and-instance-methods">Module Functions as Class and Instance Methods</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-04T10:50:51+05:30" pubdate data-updated="true">Jul 4<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Consider you have a module and a class.</p>

<p>module Mymod and a class Myclass.</p>

<p>The situation in hand is such that certain functions in the module need to end up being instance methods of the class Myclass and certain functions need to be Class methods.  You could very well imagine of such situations. Consider you are using ActiveRecord and have a sub class <strong>Subscription</strong> in correspondence with a DB table. You want to insert logic, within the module, that would work in each of the following case.</p>

<p>1) When a subscription fails or succeeds.</p>

<p>2) When an unsubscription fails or succeeds</p>

<p>You do this.</p>

<p><em>module SubscriptionLogic</em></p>

<p><em>   def  after_sub</em></p>

<p><em>      &hellip;.</em></p>

<p><em>   end</em></p>

<p><em>   def  after_unsub</em></p>

<p><em>     &hellip;.</em></p>

<p><em>   end</em></p>

<p><em>   def  after_sub_fail</em></p>

<p><em>     &hellip;.</em></p>

<p><em>   end</em></p>

<p><em>   def  after_unsub_fail</em></p>

<p><em>      &hellip;.</em></p>

<p><em>    end</em></p>

<p><em>end</em></p>

<p><em>class Subscription</em></p>

<p><em>   include SubscriptionLogic</em></p>

<p><em>   &hellip;..</em></p>

<p><em>end</em></p>

<p>You insert the logic as functions of a module, say <strong>SubscriptionLogic</strong>. Ideally you want the methods containing the logic to be instance methods of the class Subscription. You include the module SubscriptionLogic in the class and you avail all the functions in the module as Instance methods. Now you consider the case when an unsubscription fails &ndash; i.e, there is no existing subscription so that an unsub could take place.  No way is it possible that you could have a function &lsquo;logic_after_unsub_fail&#8217;  in the module SubscriptionLogic and use it as an instance method, <em><strong>simply because there is no instance available</strong></em>.  You think and decide to use the function as your class method, but you have &rsquo;<strong>include</strong>d&#8217;  the  module in your class and hence its not possible to use it as your class method. You cannot <strong>extend</strong> the entire module coz , ideally you want the logic to be instance methods.</p>

<p>So you could get this solved up by a simple piece of extra coding.</p>

<p>_module SubscriptionLogic _</p>

<p><em>  def  after_sub</em></p>

<p><em>      &hellip;.</em></p>

<p><em>  end</em></p>

<p><em>  def  after_unsub</em></p>

<p><em>      &hellip;.</em></p>

<p><em>  end</em></p>

<p><em>  def  after_sub_fail</em></p>

<p><em>      &hellip;.</em></p>

<p><em>  end</em></p>

<p><em>  module ClassMethods</em></p>

<p><em>      def after_unsub_fail</em></p>

<p><em>           &hellip;.</em></p>

<p><em>      end</em></p>

<p><em>      def self.included(base)</em></p>

<p>_          base.extend(ClassMethods)    # base pertains to the class within which you include the module. _</p>

<p><em>      end</em></p>

<p><em>   end</em></p>

<p><em>end</em></p>

<p>Now within the class insert this line.</p>

<p>_class Subscription _</p>

<p>_   include SubscriptionLogic _</p>

<p><strong><em>   extend SubscriptionLogic::ClassMethods</em></strong></p>

<p><em>   &hellip;..</em></p>

<p><em>end</em></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2011/07/03/back-after-a-long-gap">Back After a Long Gap&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-03T15:26:25+05:30" pubdate data-updated="true">Jul 3<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Haven&rsquo;t Written any thing for  quite some time now. It was last november that i actually sat down to write something. Started off my professional career then and obviously was busy with work and stuff. Need to get back to writing stuff, little and bigger stuffs that i have learnt while working. In between i have fallen in love with a a new language &ndash; Ruby, the popular choice for web apps these days.  From a person who never had any kind of fondness for OOP, i have started loving to talk about about objects and classes. Learnt the difference between fun coding and professional coding. These 6-8 months has really been a learning curve for me and i really do hope that my following posts would reflect that.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2010/11/27/getting-started-with-php-and-apache">Getting Started With PHP and Apache</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-27T14:44:10+05:30" pubdate data-updated="true">Nov 27<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Someone who gives it a thought of using PHP , apache and stuff for the first time will be faced up with a few number of fixed problems . Configuring your apache server , establishing a connection between PHP and apache , stuffs like that . Here is a basic introduction to start using these things and kick off as a web programmer .</p>

<p>Obviously you need to have PHP and apache installed on your system .</p>

<p><strong>$ : sudo apt-get install apache2</strong></p>

<p><strong>$ : sudo apt-get install php5-cli</strong></p>

<p><strong>$: sudo apt-get install libapache2-mod-php5</strong></p>

<p>would get you apache and PHP installed on your system  .</p>

<p>Using the appropriate versions is left upto individuals .</p>

<p>Just have a peep into some of the files like :</p>

<p><em>/etc/php5/apache2/php.ini</em> &mdash;&mdash;&ndash;> You would see a lot of variables set to &lsquo;ON&rsquo;  and &lsquo;OFF&rsquo; . You may well have to toggle those values as and when necessary .</p>

<p>Try starting , stopping and restarting your apache web server .</p>

<p><strong>$ :sudo  /etc/init.d/apache2 start</strong></p>

<p><strong>$: sudo /etc/init.d/apache2 stop</strong></p>

<p><strong>$: sudo /etc/init.d/apache2  restart</strong></p>

<p>Once everything is fine and and perfect  , try out your first PHP script . Script it , save it in a file with a &lsquo;.php&rsquo; extension and put your file in the directory &lsquo;/var/www &rsquo;. Now you could access this script from your browser</p>

<p><strong>localhost/&lsquo;scriptname&rsquo;</strong></p>

<p>and you see the result right there in front of you . Thats just how you enter the world of web programming .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2010/11/24/greasemonkey-customizing-your-webpages">GreaseMonkey : Customizing Your Webpages</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-24T22:04:29+05:30" pubdate data-updated="true">Nov 24<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There would have been times when you would have felt if the web page in front of you behaved a bit more according to your like . This might specially happen if the page consists of forms that you fill with data directed to live servers .  In such cases you wouldn&rsquo;t mind customizing the page to suit your needs so that you don&rsquo;t do some nonsense that would result in chaos .</p>

<p>Firefox , i see many using it as their default browser , offers a plugin called &lsquo;<strong>Grease monkey</strong>&#8216;  that allows you to do just that . All you need to is to install the plugin , write your own javascripts , install them ( thats pretty easy to do ) and start using them  .</p>

<p>Write your javascripts to customize your webpage . What you need to do in addition is to add some <strong>metadata</strong> providing extra information to greasemonkey .</p>

<p>The meta data might look as follows :</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/11/untitled-1.png"><img src="http://sunilkumarn.files.wordpress.com/2010/11/untitled-1.png?w=300" alt="" /></a></p>

<p>The first and the last lines are necessary to indicate to the greasemonkey that the script it to be processed by it .</p>

<p>The <strong>name and the description are optional</strong> . It might prove helpful to you if you have scripted and installed a number of greasemonkey scripts .</p>

<p>The 4th an the 5th line of the metadata are extremely important and needs to be well understood . <strong>These lines tell the greasemonkey the URLs on which the script is to be applied and not to be applied </strong>.</p>

<p><strong>@include</strong> &ndash;> specifies the URLs on which the script is to be installed . Here &lsquo;*&rsquo; is specified which is just a wildcard and indicates that the script is to applied on all the sites  .</p>

<p><strong>@exclude</strong> &ndash;> specifies the URLs that are to be left out . It is to be noted that @exclude is processed before @include .</p>

<p>This gives you an idea of the metadata part of the script . Now you may write your own javascript , add your metadata at the beginning and save the file with the extension &lsquo; <strong>.user.js </strong>&#8216;  .</p>

<p>To install the script , open the file in firefox and you would see an option &lsquo;install&rsquo; . Just give a click and you are ready to use your greasemonkey script .You could manage your script , disable it , uninstall it as well . Just click</p>

<p><em>Tools &mdash;&mdash;> Greasemonkey &mdash;&mdash;> Manage user scripts &hellip;.</em></p>

<p>Having another plugin &lsquo;<strong>firebug&rsquo;</strong> may help you in the process of writing the script . This allows you to view the html code of the webpage that is infront of you . Infact the plugin is almost a necessity to help you write efficient code with greasemonkey .</p>

<p>Now you may start writing your own greasemonkey scripts and customize any of the webpages as and according to your like . It&rsquo;s also to be understood that greasemonkey is a plugin of firefox . If you use Google chrome as your browser , you wouldn&rsquo;t need to install any plugin . The facility to customize the webpage is provided by default . You may use the same code that you have written to work with greasemonkey . The metadata and the process of installing is the same and obviously the results are the same as well .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2010/11/24/using-screens">Using Screens</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-24T20:43:00+05:30" pubdate data-updated="true">Nov 24<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>You might have often had the experience where you would have had to open quite a few terminals on your screen simultaneously . This might often be the case when you are doing stuffs like data processing on particular files and you intend not to sit idle during that particular time . What you do is to keep unnecessary number of terminals open on your screen .</p>

<p>You could get rid of this by using the &lsquo;screens&rsquo; option in Linux . This allows you to enter a new screen where you could perform time consuming processes like a data processing operation using the  &lsquo;awk&#8217;  command . Start the process in the screen , exit the screen and now do your own stuff in the main console , go back to your screen after a while and view the results of  whatever operations you had performed . You could do all this stuff without the necessity of opening terminals again and again .</p>

<p>Create a new Screen :</p>

<p><strong>$ : screen -S &lsquo;Screen name&rsquo; </strong></p>

<p>To detach from the current screen :</p>

<p>Use<strong> CTRL + a + d</strong></p>

<p>To terminate a screen :</p>

<p>Use <strong>CTRL + d</strong></p>

<p>To attach an already created screen :</p>

<p><strong>$ : screen -x &lsquo;screen name&rsquo;</strong></p>

<p>You could keep on creating screens within screens and keep going on as and when needed  .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2010/10/26/semaphores-and-synchronization-patterns">Semaphores and Synchronization Patterns</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-26T09:20:46+05:30" pubdate data-updated="true">Oct 26<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Semaphores as we know is a mechanism that is used to solve the issue of synchronization . The concept and use of semaphores is a bit more than what you normally call &lsquo; tricky &rsquo; .Here we try and analyze a basic synchronization pattern and solve the issue with semaphores  .</p>

<p>Have a look into the pattern given below .</p>

<p>statements in THREAD A</p>

<p>strcpy(a , &ldquo;Hello &rdquo;);   -  A1
printf(&ldquo;%s\n&rdquo; ,b);      -    B2</p>

<p>statements in THREAD B</p>

<p>strcpy(b , &ldquo;World&rdquo;)  &ndash; B1
printf(&ldquo;%s\n&rdquo; ,a);    -  A2</p>

<p>Here we have two threads which consists of two statements each .
<strong>Constraint :</strong>
What we need to ensure is that the statements suffixed A1 &amp; B1 are executed before the statements suffixed A2 &amp; B2  execute. Here the two threads &lsquo;rendezvous &rsquo; at a point of execution and is not allowed to proceed until both have arrived .</p>

<p>Without using a mechanism like semaphore , no way is it possible to ensure such a constraint due to the scheduling mechanism that cannot be predicted . Hence we use semaphores to solve this issue .</p>

<p>To ensure that it works according to wish  , we do this  :</p>

<p>THREAD A</p>

<p>strcpy(a , &ldquo;Hello &rdquo;);  &ndash; A1
up(sem1);
down(sem2);
printf(&ldquo;%s\n&rdquo; ,b);   &ndash; B2</p>

<p>THREAD B</p>

<p>strcpy(b , &ldquo;World&rdquo;);  &ndash; B1
up(sem2);
down(sem1);
printf(&ldquo;%s\n&rdquo; ,a);   &ndash; A1</p>

<p>Now we need to give a thought on how this works .
Here we have two semaphores ,sem1 and sem2 as we have two critical sections</p>

<p>Now , how is the synchronization issue solved  .?
The &lsquo;<strong>down</strong> &rsquo; operation just before the two statements suffixed &lsquo;2&rsquo; ensures that the two statements are not executed until the &lsquo;<strong>up&rsquo;</strong> operation on the corresponding semaphore is not invoked . Hence whichever be the order of scheduling , both the threads rendezvous at a point  and will not proceed ( as a result of the &lsquo;down&rsquo; operation  )until the next thread arrives (and the corresponding &lsquo;up&rsquo; operation is performed ).</p>

<p>This synchronization pattern as been solved using semaphores .</p>

<p>You could find the solution to these and more such patterns from <a href="http://github.com/sunilkumarn/Synchroniation_patterns">here</a> .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2010/10/21/memcheck-a-memory-error-detection-tool">Memcheck : A Memory Error Detection Tool</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-21T09:13:49+05:30" pubdate data-updated="true">Oct 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Linux distros provide a  tool suite called <strong>&lsquo;Valgrind&rsquo;</strong> that consists of a number of tools that help you make your programs faster and more correct . The most popular tool out of this is called is <strong>memcheck</strong> that is used to detect memory related errors in C and C++ programs that can lead to serious issues like  segfaults and even more grevious issues like unpredictable behaviours .</p>

<p>Lets take a look into how we use the tool &lsquo;memcheck&rsquo; so that we detect , try and avoid the memory related issues in our program.</p>

<p>First of all we need to create a memory leak so that we have something to detect .</p>

<p>We write a program that consists of a memory leak . Here is one such in a file &lsquo; pgm.c&rsquo;</p>

<p><code>1 #include &lt;stdlib.h&gt;
2 #include &lt;string.h&gt;
3 void f(char *s)
4 {
5 char *x = malloc(strlen(s));
6 x[7] = 0;
7 }</code></p>

<p><code>8 int  main()
9 {
10 char *s="Hello";
11 f(s);
12 }</code></p>

<p>As you could see , there are two major memory related bugs in this code:</p>

<p>1) Trying to write in the location x[7] which is out of the allocated memory space .This will lead to what is called a <strong>&lsquo;heap block overrun</strong>&rsquo; .</p>

<p>2) The memory that is allocated to x remains unused . This memory becomes garbage on returning from the function . In short , you have seen a <strong>&lsquo;memory leak</strong> &rsquo;.</p>

<p>Now lets try and detect the two problems using memcheck :</p>

<p>You need to have valgrind installed in your system .
<strong>$ : apt-get install valgrind</strong>
if you don&rsquo;t have it already .</p>

<p>Do</p>

<p><strong>$: cc -g pgm.c</strong></p>

<p>We  compile the program using the -g option so that the line number informations are displayed when using memcheck .</p>

<p>Do</p>

<p><strong>$: valgrind  &mdash;leak-check = yes a.out</strong></p>

<p>the option  &lsquo; &mdash;leak-check &rsquo; being set equal to yes displays the informations on memory leak issues .</p>

<p>Now lets look out what are the informations that are being displayed when the memcheck tool is used .</p>

<p>First lets have a look into the &lsquo;heap block overrun&rsquo; problem :</p>

<p><code>==3350== Invalid write of size 1
==3350==    at 0x80483F6: f (pgm.c:6)
==3350==    by 0x804841D: main (pgm.c:11)
==3350==  Address 0x419102f is 2 bytes after a block of size 5 alloc'd
==3350==    at 0x4023D6E: malloc (vg_replace_malloc.c:207)
==3350==    by 0x80483EC: f (pgm.c:5)
==3350==    by 0x804841D: main (pgm.c:11)</code></p>

<p>The above few lines is the code that was generated by memcheck  .</p>

<p>&lsquo;3350&rsquo; is the process id .</p>

<p>The actual error is seen right at the first line .</p>

<p>&lsquo;Invalid write  of size 1&rsquo; .</p>

<p>You get a stack trace right after this line , that</p>

<p>the invalid write has occured at the 6th line as a result of the 12th line . You could see what line numbers &lsquo;6&rsquo; and &lsquo;11&rsquo; do by having a look into our code , its the point of occurence of the error and the function call respectively.</p>

<p>A line showing the the fact that the location you are trying to access ( x[7] ) is 2 bytes after the allocated area can also be seen added with lines that contain information about the main and the function   .These lines provide great help to the programmer especially when the case becomes a lot more complicated .</p>

<p>Now the informations that are displayed about the &lsquo;memory leak problem&rsquo; can also be looked into .</p>

<p><code>==3350== LEAK SUMMARY:
==3350==    definitely lost: 5 bytes in 1 blocks.
==3350==    possibly lost: 0 bytes in 0 blocks.
==3350==    still reachable: 0 bytes in 0 blocks.
==3350==    suppressed: 0 bytes in 0 blocks.
</code>
You could view the lines that provide information about the memory leak problem .
The first line of the &lsquo;LEAK SUMMARY &rsquo; is the most significant to us . It shows the amount of memory definitely lost ( 5 Bytes ). Changes need to be made in the program so that the memory leak is prevented .</p>

<p>Memcheck produces these result which helps the programmer so as to view and correct the memory related issues rather convincingly . It needs to be noted that Memcheck is a <strong>&lsquo;dynamic instrumentation tool </strong>&rsquo; and not a static tool like &lsquo;lint &rsquo; . Hence to detect the memory leaks in a program , the control actually needs to get transferred to that segment of the program where the issues occur . In short you need to invoke the function &lsquo;f&rsquo; from your &lsquo;main&rsquo; so that Memcheck could detect those memory related issues that exists within the function &lsquo;f&rsquo; .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2010/10/19/common-subexpression-elimination-cse">Common Subexpression Elimination by GCC</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-19T17:12:16+05:30" pubdate data-updated="true">Oct 19<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>Common subexpression elimination</strong> (CSE) is a compiler optimization technique of finding redundant expression evaluations, and replacing them with a single computation . This saves the time overhead resulted by evaluating the expression for more than once . We will have a look into this phenomenon by considering a simple code and again taking a walk through its assembly code .</p>

<p>Consider the code that we have written and saved in file &lsquo; pgm.c &rsquo;</p>

<p><code>main(){
int i, j, k, r;
scanf("%d%d", &amp;i, &amp;j);
k = i + j + 10;
r = i + j + 30;
printf("%d %d\n", k, r);
}</code></p>

<p>Do :</p>

<p><strong>$ : cc -S pgm.c</strong></p>

<p><strong>$ : less pgm.s</strong></p>

<p>Read the assembly code &lsquo; pgm.s &rsquo;</p>

<p>Scan the assembly code and find out the call to the function &lsquo;scanf()&rsquo; . This is where our area of interest begins . This is because its after calling &lsquo;scanf &rsquo; that we load the value of the input variables into the registers .</p>

<p>Right after the call to &lsquo;scanf &rsquo; , i have this in my assembly code ,</p>

<p><strong>movl    -16(%ebp), %edx
movl    -20(%ebp), %eax</strong> .</p>

<p>Here we move the values of the two variables &lsquo;i &rsquo; and &lsquo;j &rsquo; into registers &lsquo;edx &rsquo; and &lsquo;eax &rsquo; .</p>

<p>Now just have a look into our C code and you will see the two expressions as follows :</p>

<p><code>k = i + j + 10;
r = i + j + 30;</code></p>

<p>Looking at the two expressions , you would find out the redundant part in the two expressions .</p>

<p>Its that &lsquo;i+j&rsquo; is calculated twice .</p>

<p>Now lets find out what happens in the assembly code :</p>

<p>I had these statements in your assembly code :</p>

<p><strong>movl    -16(%ebp), %edx</strong></p>

<p><strong>movl    -20(%ebp), %eax</strong> &mdash;&mdash;&mdash;&mdash;&mdash;> We had mentioned these two statements  above .</p>

<p><strong>leal   (%edx,%eax), %eax</strong> &mdash;&mdash;&mdash;&mdash;>  values in edx and eax are added and loaded into eax</p>

<p><strong>addl    $10, %eax</strong> &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;>  the constant 10 is added with the value in eax</p>

<p><strong>leal   (%edx,%eax), %eax</strong> &mdash;&mdash;&mdash;&mdash;&ndash;>   values in edx and eax are added and loaded into eax</p>

<p><strong>addl    $30, %eax</strong> &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;>  the constant 30 is added with the value in eax</p>

<p>You could see that there is redundancy in the assembly code .</p>

<p>The statement<strong> &lsquo; leal(%edx,%eax), %eax</strong> &rsquo; performs the evaluation of the subexpression ( &lsquo; i + j &rsquo; ) which is done twice thereby throwing in redundancy and hence creating unnecessary overheads .</p>

<p>Obviously our compiler when asked to perform optimization would avoid this redundancy .This is what is termed as <strong>Common Subexpression Elimination</strong> ,i.e , the subexpression that is common( &lsquo; i + j &rsquo; ) in the two expressions is evaluated only once , in essence the second evaluation is eliminated .  Lets have a look into CSE by again peeping into our assembly code  .</p>

<p>Do</p>

<p><strong>$ : cc &ndash; S &ndash; O3 pgm .c</strong></p>

<p><strong>$ : less pgm.s</strong></p>

<p>Take a look into your assembly code  .</p>

<p>As mentioned above , our area of interest starts from the call to &lsquo;scanf ()&rsquo; .</p>

<p>Instead of those 6 statements that were used to evaluate those two expressions ,</p>

<p>i + j + 10 &amp; i + j + 30 ,</p>

<p>you would find this ,</p>

<p><strong>movl    -12(%ebp), %eax </strong>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;>  move the value of the variable &lsquo;i&rsquo; into eax</p>

<p><strong>addl    -8(%ebp), %eax </strong>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;> add the value of the variable &lsquo;j&rsquo; with &lsquo;i&rsquo; stored in eax .</p>

<p><strong>leal    30(%eax), %edx</strong> &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;> adds 30 with eax ( contains the sum of i &amp; j ) and stores in edx</p>

<p><strong>addl    $10, %eax </strong>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;> adds 10 with eax ( contains the sum of i &amp; j ) and stores in eax .</p>

<p>Here the second statement performs the evaluation of the subexpression , &lsquo; i + j &rsquo; . You could get it quite clearly from the code segment that the redundancy that was found in the unoptimized assembly code has been eliminated by the compiler .</p>

<p>The later 2 statements perform the evaluation of the expressions</p>

<p>( i + j + 30 )   and    ( i + j + 10 ) respectively .</p>

<p>We have just used a very simple case of CSE , but this optimization technique could be used in even more useful cases . Consider :</p>

<p>k = f() + g() + 30</p>

<p>r = f() + g() + 10</p>

<p>where f() and g() are functions . In an unoptimized code , the technique of CSE wouldn&rsquo;t be used and hence there would be overhead due to the redundancy added with the more serious problem of having to call each function twice . The technique of <strong>Common Subexpression Elimination</strong> avoids this very redundancy  .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2010/10/19/function-inlining">Function inlining</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-19T15:43:05+05:30" pubdate data-updated="true">Oct 19<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Function inlining is performed when a request has been made to the compiler to perform optimization on the code . The compiler will try (its important to remember that ,it is a request made to the compiler, not an order) and insert the complete body of the function in every place in the code where that function is used so as to eliminate the time overhead when the function is called . We could get an idea of function inlining by peeping into the assembly code generated by the compiler .</p>

<p>We do this with the help of a small program :</p>

<p><code>int sqr(int x)
{
return x*x;
}</code></p>

<p><code>main()
{
printf("%d\n", sqr(10));
}</code></p>

<p>We have the program written in a file  &lsquo;pgm.c&rsquo;</p>

<p>Do :</p>

<p><strong>$: cc -S pgm.c
</strong>
We could now view the assembly code generated by the compiler</p>

<p>Do:</p>

<p><strong>$: less pgm.s</strong></p>

<p>I found out the following lines in the &lsquo;main&rsquo; function of &lsquo; pgm.s &rsquo;</p>

<p><code>movl    $10, (%esp)
call    sqr
</code>
You would have the idea cleared up</p>

<p>The constant &lsquo;10 &#8216;  is stored in the stack , and the call to the function &#8216;sqr &rsquo; is made . The result of squaring up 10 is performed in the function &lsquo;sqr&rsquo; . This obviously would create overheads for invoking the function .</p>

<p>Now consider the case where you have requested the compiler to perform all optimizations on your code .</p>

<p><strong>$ :cc -S -O3 pgm.c</strong></p>

<p>Now have a look into your assembly code .</p>

<p><strong>$ :less pgm.s
</strong></p>

<p>Now just have a look into the your &lsquo;main&rsquo; function and find out what you see where you had seen the previous two lines that i did mention above .</p>

<p>You would just find a singe line corresponding to those two lines which you had found in your assembly code that was not optimized .</p>

<p>This is what i found ,</p>

<p><code>movl    $100, 4(%esp)
</code></p>

<p>The final value that you obtain after finding the square of 10 ( i.e 100 ) is has been moved into the stack , but where is the call to the function &lsquo;sqr&rsquo; ?</p>

<p>You have just seen &lsquo; <em><strong>function inlining</strong></em> &rsquo;. The function body had been inserted at the point where the function was used and the value &lsquo;100 &rsquo; calculated at compile time instead of performing the calculation at run time .This saves a lot of time that would have been required to calculate the value of &lsquo;100&rsquo; by making a call to the function at run time .Performing function inlining avoids this .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/technical/2010/10/18/python-db-api">Python DB-API</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-18T23:53:31+05:30" pubdate data-updated="true">Oct 18<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Python is one of the more popular Open Source programming languages, owing largely to its own native expressiveness as well as to the variety of support modules that are available to extend its capabilities. One of these modules is DB-API, which, as the name implies, provides a database application programming interface. We will have a discussion about how to connect and use a General purpose database system like Mysql with Python. The DB API provides a minimal standard for working with databases, using Python structures and syntax wherever possible .</p>

<p>4 Steps of the Python DB-API includes the following:</p>

<p>1) Importing the API module.</p>

<p>2) Acquiring a connection with the database.</p>

<p>3) Issuing SQL statements and stored procedures.</p>

<p>4) Closing the connection
There are lots of database systems that are available .Here we use Mysql as our database system .You could also use database systems like PostgreSQL, SQL Server etc. Python&rsquo;s DB-API uses a two-level architecture in which the top level provides an abstract interface that is similar for all supported database engines, and a lower level consisting of drivers for specific engines that handle engine-dependent details. This means, of course, that to use DB-API for writing Python scripts, you must have a driver for your particular database system. Since we have  fixed our database system as MySQL, DB-API provides database access by means of the MySQLdb driver . Therefore we need a module <strong>MySQLdb</strong> in Python &lsquo;&rsquo; .</p>

<p>At first , we need to get Mysql installed in our system.</p>

<p><strong>$: apt-get install mysql-server-5.0</strong></p>

<p>Just try and enter into the interactive prompt of mysql .</p>

<p><strong> $: mysql -u &lsquo;user&rsquo; -p</strong></p>

<p>You will get your mysql interactive prompt where you could just brush up your sql knowledge.</p>

<p><em><strong>Step 1) Importing the API module.</strong></em></p>

<p>You need to make sure that you that have MySQLdb installed on your machine.</p>

<p>Do this:</p>

<p><strong>$: python</strong></p>

<p><strong>>>>import MySQLdb</strong></p>

<p>Obviously if you dont have it installed , you would be getting this :</p>

<p><strong>Traceback (most recent call last):</strong></p>

<p><strong>File &ldquo;<stdin>&rdquo;, line 1, in <module></strong></p>

<p><strong>ImportError: No module named MySQLdb</strong></p>

<p>To install MySQLdb module, download it from <a href="http://sourceforge.net/projects/mysql-python">MySQLdb Download</a> page and proceed as follows:</p>

<pre><code>$ gunzip MySQL-python-1.2.2.tar.gz
$ tar -xvf MySQL-python-1.2.2.tar
$ cd MySQL-python-1.2.2
$ python setup.py build
$ python setup.py install
</code></pre>

<p>Now do</p>

<p><strong>$ : python</strong></p>

<p><strong>>>>import MySQLdb</strong></p>

<p><strong>>>></strong></p>

<p>We have done with Step 1) out of the 4 steps of the Python DB-API .</p>

<p>Now we move into step 2). The prerequisite for performing step 2) of the DB-API is that you need to create a database ( &lsquo;Persons&rsquo; in our examples to follow ) in mysql .</p>

<p>You could do this by :</p>

<p><strong>$: mysql -u &lsquo;user&rsquo; -p</strong></p>

<p>Enter  mysql .</p>

<p>Do :</p>

<p><strong>mysql>CREATE DATABASE Persons;</strong></p>

<p><strong>mysql>Query OK, 1 row affected (0.03 sec)</strong></p>

<p>Once you have done with this</p>

<p><em><strong>Step 2 ) Acquiring a connection with the database.</strong></em></p>

<p><em>conn = MySQLdb.connect (host = &ldquo;localhost&rdquo;,</em></p>

<p><em>user = &ldquo;user&rdquo;,</em></p>

<p><em>passwd = &ldquo;asdfgh&rdquo;,</em></p>

<p><em>db = &ldquo;Persons&rdquo;)</em></p>

<p>Here we open a database connection using the &lsquo;connect&rsquo; function of the MySQLdb module.</p>

<p>The four parameters that are passed to the function &lsquo;connect&rsquo;  are :</p>

<p><strong>host</strong> &mdash;       the system in which the database is created</p>

<p><strong>user</strong> &mdash;       the user who is trying to acquire a connection with the database ( the user must be authenticated with mysql if the attempt to create a connection needs to be successful.</p>

<p><strong>passwd</strong> &mdash;      the password of the mysql database system .</p>

<p><strong>db</strong> &mdash;      the name of the database created using mysql  .</p>

<p>If the &lsquo;connect()&rsquo; call succeeds, it returns a connection object that serves as the basis for further interaction with MySQL( here &lsquo;conn&rsquo;). If the call fails, it raises an exception .Therefore you better perform exception handling so that you get to know more about the root cause of the error.</p>

<p><em>try:</em></p>

<p><em>conn = MySQLdb.connect (host = &ldquo;localhost&rdquo;,</em></p>

<p><em>user = &ldquo;root&rdquo;,</em></p>

<p><em>passwd = &ldquo;asdfgh&rdquo;,</em></p>

<p><em>db = &ldquo;Persons&rdquo;)</em></p>

<p><em>except MySQLdb.Error,e:</em></p>

<p><em>print &ldquo;Error occured &rdquo;,e.args[0],e.args[1]</em></p>

<p><em>sys.exit (1)</em></p>

<p>_
_</p>

<p>Here on an unsuccessful attempt to make a connection , an exception is raised ( MySQLdb.Error ) , the information about the error is stored in e.args[1] .</p>

<p><em><strong>Step 3) Issuing SQL statements and stored procedures.</strong></em></p>

<p>Now we need to create a cursor object for the connection between Python and mysql so that all the functions performed by sql are performed within from Python now . We create a cursor object using the &lsquo; cursor()&rsquo; method .</p>

<p>We are all set to execute sql statements in an Object oriented environment , and thats using the &lsquo;execute()&rsquo; function . Any sql statement can be called in from Python using the &lsquo;execute()&rsquo; function.</p>

<p>Consider you want to create a new table in our database &lsquo;Persons&rsquo; .</p>

<p><em>cursor.execute(&ldquo;&rdquo;&ldquo;</em></p>

<p><em>CREATE TABLE PERSON</em></p>

<p><em>(</em></p>

<p><em>ID               int,</em></p>

<p><em>lastname     CHAR(40),</em></p>

<p><em>firstname    CHAR(40),</em></p>

<p><em>City      CHAR(40)</em></p>

<p><em>)</em></p>

<p><em>&ldquo;&rdquo;&ldquo;)</em></p>

<p>You have created a table named &lsquo;PERSON &rsquo; with fields as mentioned above .</p>

<p>As you would imagine , any other statements could be performed as such , for eg.</p>

<p><em>cursor.execute (&ldquo;&rdquo;&ldquo;</em></p>

<p><em>INSERT INTO PERSON (ID, lastname,firstname,City)</em></p>

<p><em>VALUES</em></p>

<p><em>(1,&lsquo;KUMAR&rsquo;,&lsquo;SUNIL&rsquo;,&lsquo;KANNUR&rsquo;),</em></p>

<p><em>(2,&lsquo;JOHN&rsquo;,&lsquo;HARI&rsquo;,&lsquo;KOTTAYAM&rsquo;)</em></p>

<p><em>&ldquo;&rdquo;&ldquo;)</em></p>

<p>or</p>

<p><em>cursor.execute (&ldquo;SELECT * FROM PERSON WHERE City like &lsquo;K%&rsquo;&rdquo;)</em></p>

<p>and any of the sql statements .</p>

<p><em><strong> Step 4) Closing the connection</strong></em></p>

<p><em>conn.close()</em></p>

<p>Here we have terminated the connection after all our need with the DB-API has been done with . The DB-API allows us to update , insert , retrieve and modify within a database in a simple and elegant way .</p>

<p>We have tried and demonstrated a simple example of how to use the Python DB-API .</p>

<p>Using Python with Sql,we have found an object-relational mapping where the object-oriented programming paradigm of Python meets the relational paradigm of Sql. An object-relational mapping is a bridge between the two worlds. As we saw , it lets us define classes that correspond to the tables of a database. Later , we use methods on those classes and their instances to interact with the database .</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/technical/blog/page/3/">&larr; Older</a>
    
    <a href="/technical/blog/archives">Blog Archives</a>
    
    <a class="next" href="/technical/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/technical/2013/09/01/migrating-from-wordpress-to-jekyll-in-ten-steps">Migrating From Wordpress to Jekyll in Ten Steps</a>
      </li>
    
      <li class="post">
        <a href="/technical/2013/07/07/node-js-event-emitters-and-listeners">Node.js: Event Emitters and Listeners</a>
      </li>
    
      <li class="post">
        <a href="/technical/2013/07/06/rails-admin-with-authlogic">Rails Admin With Authlogic</a>
      </li>
    
      <li class="post">
        <a href="/technical/2013/06/28/prototypal-inheritance-in-javascript">Prototypal Inheritance in Javascript</a>
      </li>
    
      <li class="post">
        <a href="/technical/2013/06/23/node-js-streams-and-pipes">Node.js: Streams and Pipes.</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Sunil Kumar -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
