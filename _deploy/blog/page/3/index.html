
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Scribblings</title>
  <meta name="author" content="Sunil Kumar">

  
  <meta name="description" content="Function inlining is performed when a request has been made to the compiler to perform optimization on the code . The compiler will try (its &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sunilkumarn.github.io/technical/blog/page/3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Scribblings" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Scribblings</a></h1>
  
    <h2>Scribbling down experiences.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sunilkumarn.github.io/technical" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/19/function-inlining">Function inlining</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-19T15:43:05+05:30" pubdate data-updated="true">Oct 19<span>th</span>, 2010</time>
        
         | <a href="/2010/10/19/function-inlining#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Function inlining is performed when a request has been made to the compiler to perform optimization on the code . The compiler will try (its important to remember that ,it is a request made to the compiler, not an order) and insert the complete body of the function in every place in the code where that function is used so as to eliminate the time overhead when the function is called . We could get an idea of function inlining by peeping into the assembly code generated by the compiler .</p>

<p>We do this with the help of a small program :</p>

<p><code>int sqr(int x)
{
return x*x;
}</code></p>

<p><code>main()
{
printf("%d\n", sqr(10));
}</code></p>

<p>We have the program written in a file  &lsquo;pgm.c&rsquo;</p>

<p>Do :</p>

<p><strong>$: cc -S pgm.c
</strong>
We could now view the assembly code generated by the compiler</p>

<p>Do:</p>

<p><strong>$: less pgm.s</strong></p>

<p>I found out the following lines in the &lsquo;main&rsquo; function of &lsquo; pgm.s &rsquo;</p>

<p><code>movl    $10, (%esp)
call    sqr
</code>
You would have the idea cleared up</p>

<p>The constant &lsquo;10 &#8216;  is stored in the stack , and the call to the function &#8216;sqr &rsquo; is made . The result of squaring up 10 is performed in the function &lsquo;sqr&rsquo; . This obviously would create overheads for invoking the function .</p>

<p>Now consider the case where you have requested the compiler to perform all optimizations on your code .</p>

<p><strong>$ :cc -S -O3 pgm.c</strong></p>

<p>Now have a look into your assembly code .</p>

<p><strong>$ :less pgm.s
</strong></p>

<p>Now just have a look into the your &lsquo;main&rsquo; function and find out what you see where you had seen the previous two lines that i did mention above .</p>

<p>You would just find a singe line corresponding to those two lines which you had found in your assembly code that was not optimized .</p>

<p>This is what i found ,</p>

<p><code>movl    $100, 4(%esp)
</code></p>

<p>The final value that you obtain after finding the square of 10 ( i.e 100 ) is has been moved into the stack , but where is the call to the function &lsquo;sqr&rsquo; ?</p>

<p>You have just seen &lsquo; <em><strong>function inlining</strong></em> &rsquo;. The function body had been inserted at the point where the function was used and the value &lsquo;100 &rsquo; calculated at compile time instead of performing the calculation at run time .This saves a lot of time that would have been required to calculate the value of &lsquo;100&rsquo; by making a call to the function at run time .Performing function inlining avoids this .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/18/python-db-api">Python DB-API</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-18T23:53:31+05:30" pubdate data-updated="true">Oct 18<span>th</span>, 2010</time>
        
         | <a href="/2010/10/18/python-db-api#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Python is one of the more popular Open Source programming languages, owing largely to its own native expressiveness as well as to the variety of support modules that are available to extend its capabilities. One of these modules is DB-API, which, as the name implies, provides a database application programming interface. We will have a discussion about how to connect and use a General purpose database system like Mysql with Python. The DB API provides a minimal standard for working with databases, using Python structures and syntax wherever possible .</p>

<p>4 Steps of the Python DB-API includes the following:</p>

<p>1) Importing the API module.</p>

<p>2) Acquiring a connection with the database.</p>

<p>3) Issuing SQL statements and stored procedures.</p>

<p>4) Closing the connection
There are lots of database systems that are available .Here we use Mysql as our database system .You could also use database systems like PostgreSQL, SQL Server etc. Python&rsquo;s DB-API uses a two-level architecture in which the top level provides an abstract interface that is similar for all supported database engines, and a lower level consisting of drivers for specific engines that handle engine-dependent details. This means, of course, that to use DB-API for writing Python scripts, you must have a driver for your particular database system. Since we have  fixed our database system as MySQL, DB-API provides database access by means of the MySQLdb driver . Therefore we need a module <strong>MySQLdb</strong> in Python &lsquo;&rsquo; .</p>

<p>At first , we need to get Mysql installed in our system.</p>

<p><strong>$: apt-get install mysql-server-5.0</strong></p>

<p>Just try and enter into the interactive prompt of mysql .</p>

<p><strong> $: mysql -u &lsquo;user&rsquo; -p</strong></p>

<p>You will get your mysql interactive prompt where you could just brush up your sql knowledge.</p>

<p><em><strong>Step 1) Importing the API module.</strong></em></p>

<p>You need to make sure that you that have MySQLdb installed on your machine.</p>

<p>Do this:</p>

<p><strong>$: python</strong></p>

<p><strong>>>>import MySQLdb</strong></p>

<p>Obviously if you dont have it installed , you would be getting this :</p>

<p><strong>Traceback (most recent call last):</strong></p>

<p><strong>File &ldquo;<stdin>&rdquo;, line 1, in <module></strong></p>

<p><strong>ImportError: No module named MySQLdb</strong></p>

<p>To install MySQLdb module, download it from <a href="http://sourceforge.net/projects/mysql-python">MySQLdb Download</a> page and proceed as follows:</p>

<pre><code>$ gunzip MySQL-python-1.2.2.tar.gz
$ tar -xvf MySQL-python-1.2.2.tar
$ cd MySQL-python-1.2.2
$ python setup.py build
$ python setup.py install
</code></pre>

<p>Now do</p>

<p><strong>$ : python</strong></p>

<p><strong>>>>import MySQLdb</strong></p>

<p><strong>>>></strong></p>

<p>We have done with Step 1) out of the 4 steps of the Python DB-API .</p>

<p>Now we move into step 2). The prerequisite for performing step 2) of the DB-API is that you need to create a database ( &lsquo;Persons&rsquo; in our examples to follow ) in mysql .</p>

<p>You could do this by :</p>

<p><strong>$: mysql -u &lsquo;user&rsquo; -p</strong></p>

<p>Enter  mysql .</p>

<p>Do :</p>

<p><strong>mysql>CREATE DATABASE Persons;</strong></p>

<p><strong>mysql>Query OK, 1 row affected (0.03 sec)</strong></p>

<p>Once you have done with this</p>

<p><em><strong>Step 2 ) Acquiring a connection with the database.</strong></em></p>

<p><em>conn = MySQLdb.connect (host = &ldquo;localhost&rdquo;,</em></p>

<p><em>user = &ldquo;user&rdquo;,</em></p>

<p><em>passwd = &ldquo;asdfgh&rdquo;,</em></p>

<p><em>db = &ldquo;Persons&rdquo;)</em></p>

<p>Here we open a database connection using the &lsquo;connect&rsquo; function of the MySQLdb module.</p>

<p>The four parameters that are passed to the function &lsquo;connect&rsquo;  are :</p>

<p><strong>host</strong> &mdash;       the system in which the database is created</p>

<p><strong>user</strong> &mdash;       the user who is trying to acquire a connection with the database ( the user must be authenticated with mysql if the attempt to create a connection needs to be successful.</p>

<p><strong>passwd</strong> &mdash;      the password of the mysql database system .</p>

<p><strong>db</strong> &mdash;      the name of the database created using mysql  .</p>

<p>If the &lsquo;connect()&rsquo; call succeeds, it returns a connection object that serves as the basis for further interaction with MySQL( here &lsquo;conn&rsquo;). If the call fails, it raises an exception .Therefore you better perform exception handling so that you get to know more about the root cause of the error.</p>

<p><em>try:</em></p>

<p><em>conn = MySQLdb.connect (host = &ldquo;localhost&rdquo;,</em></p>

<p><em>user = &ldquo;root&rdquo;,</em></p>

<p><em>passwd = &ldquo;asdfgh&rdquo;,</em></p>

<p><em>db = &ldquo;Persons&rdquo;)</em></p>

<p><em>except MySQLdb.Error,e:</em></p>

<p><em>print &ldquo;Error occured &rdquo;,e.args[0],e.args[1]</em></p>

<p><em>sys.exit (1)</em></p>

<p>_
_</p>

<p>Here on an unsuccessful attempt to make a connection , an exception is raised ( MySQLdb.Error ) , the information about the error is stored in e.args[1] .</p>

<p><em><strong>Step 3) Issuing SQL statements and stored procedures.</strong></em></p>

<p>Now we need to create a cursor object for the connection between Python and mysql so that all the functions performed by sql are performed within from Python now . We create a cursor object using the &lsquo; cursor()&rsquo; method .</p>

<p>We are all set to execute sql statements in an Object oriented environment , and thats using the &lsquo;execute()&rsquo; function . Any sql statement can be called in from Python using the &lsquo;execute()&rsquo; function.</p>

<p>Consider you want to create a new table in our database &lsquo;Persons&rsquo; .</p>

<p><em>cursor.execute(&ldquo;&rdquo;&ldquo;</em></p>

<p><em>CREATE TABLE PERSON</em></p>

<p><em>(</em></p>

<p><em>ID               int,</em></p>

<p><em>lastname     CHAR(40),</em></p>

<p><em>firstname    CHAR(40),</em></p>

<p><em>City      CHAR(40)</em></p>

<p><em>)</em></p>

<p><em>&ldquo;&rdquo;&ldquo;)</em></p>

<p>You have created a table named &lsquo;PERSON &rsquo; with fields as mentioned above .</p>

<p>As you would imagine , any other statements could be performed as such , for eg.</p>

<p><em>cursor.execute (&ldquo;&rdquo;&ldquo;</em></p>

<p><em>INSERT INTO PERSON (ID, lastname,firstname,City)</em></p>

<p><em>VALUES</em></p>

<p><em>(1,&lsquo;KUMAR&rsquo;,&lsquo;SUNIL&rsquo;,&lsquo;KANNUR&rsquo;),</em></p>

<p><em>(2,&lsquo;JOHN&rsquo;,&lsquo;HARI&rsquo;,&lsquo;KOTTAYAM&rsquo;)</em></p>

<p><em>&ldquo;&rdquo;&ldquo;)</em></p>

<p>or</p>

<p><em>cursor.execute (&ldquo;SELECT * FROM PERSON WHERE City like &lsquo;K%&rsquo;&rdquo;)</em></p>

<p>and any of the sql statements .</p>

<p><em><strong> Step 4) Closing the connection</strong></em></p>

<p><em>conn.close()</em></p>

<p>Here we have terminated the connection after all our need with the DB-API has been done with . The DB-API allows us to update , insert , retrieve and modify within a database in a simple and elegant way .</p>

<p>We have tried and demonstrated a simple example of how to use the Python DB-API .</p>

<p>Using Python with Sql,we have found an object-relational mapping where the object-oriented programming paradigm of Python meets the relational paradigm of Sql. An object-relational mapping is a bridge between the two worlds. As we saw , it lets us define classes that correspond to the tables of a database. Later , we use methods on those classes and their instances to interact with the database .</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/16/implementing-the-avl-tree">Implementing the Avl Tree</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-16T09:51:58+05:30" pubdate data-updated="true">Oct 16<span>th</span>, 2010</time>
        
         | <a href="/2010/10/16/implementing-the-avl-tree#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>AVL Tree is a <strong>self-balancing binary search tree</strong> and it was the first such structure to be invented. The  tree is said to be balanced because the difference in the heights of the child subtrees differ by atmost one. The operations Insertion, Deletion and Lookup on an Avl tree is of the order of  <em>Log n</em> because of this balancing act. Here we take a look into the implementation of an AVL tree .</p>

<p>First we need to give a thought on the term &lsquo;balance Factor&rsquo; and on the major operations that are involved in the making of such a tree.</p>

<p><strong>Balance Factor:</strong>Balance factor is associated with each node of the Avl tree. Its the difference between the heights of the left subtree and right subtree of that particular node.</p>

<p><em>Balance factor = height of left    subtree – height of right subtree.</em></p>

<p>A balance Factor of 0 , +1 or -1 for each and every node of the tree indicates that its balanced. Whenever the balance Factor of any of the nodes equals – or + 2 , the tree becomes unbalanced and needs to undergo balancing.</p>

<p>Now lets just peep into the major operations that are involved in the build up of the tree.</p>

<p>There are 3 of them</p>

<p>1) Insertion:2) Deletion:3) Rotation:
Insertion is the usual process. There is nothing special in inserting a node into an Avl tree than in inserting it to a normal binary search tree.</p>

<p>Deletion is again the same with a minor difference which we will look in to as we continue.</p>

<p>Rotation is the balancing act- The operation that distinguishes an Avl tree from the normal binary search tree. Rotation needs to be performed whenever the tree goes out of balance – this could happen as a result of the first two operations ( Insertion and Deletion ).  The Balance factor may go beyond 1 and hence the tree will have to be balanced so that it remains as an Avl tree. Each of the three operations , specially that of rotation will have to be given due care in building up an Avl tree.</p>

<p>You could sum it up this way :</p>

<p><strong>Each insertion in an Avl tree is a combination of normal insertion into a binary search tree added  with finding out whether the tree is unbalanced or not followed by rotation if necessary.</strong></p>

<p><strong>Each deletion in an Avl tree is a combination of normal deletion into a binary search tree added with  finding out whether the tree is unbalanced or not followed by rotation if necessary.</strong></p>

<p>Before we get into more details of each of them , we will have a look into the way each node is implemented in the Avl tree.</p>

<p>Each and every node in the Avl tree is implemented as a structure .This is same as what is done in an ordinary BST , <strong>since Avl tree is itself a BST.</strong></p>

<p><code>struct node{</code></p>

<p><code>int data;
</code>
<code>struct node *parent,*left,*right;</code></p>

<p><code>}*p,*root=0;</code></p>

<p>The field &lsquo;data&rsquo; contains the actual data that is to be stored in the node .There are three pointers of the type &lsquo;struct node*&rsquo;.</p>

<p><em>*left –>    points to the left child of the node</em></p>

<p><em>*right –>   points to the right child.</em></p>

<p><em>*parent –> points to the parent node .</em></p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/node.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/node.png?w=231" alt="" /></a></p>

<p>Now lets get into the details of the different operations performed on the Avl tree.</p>

<p>Inserting into an Avl Tree can pictorially be represented as follows:</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/untitled-1.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/untitled-1.png?w=300" alt="" /></a></p>

<p>Obviously , there are other functions that are involved  in the process, but the ones shown in figure are the significant ones.</p>

<p><strong>avl_insert :</strong> As discussed earlier insertion into an avl tree consists of the normal insertion followed by the checks for balancing and rotation if necessary. Normal insertion is performed first . Then the function self_bal() is called :</p>

<p><strong>self_bal() </strong>:   The newly inserted node would obviously be balanced since it wont have any children. Therefore the balance factors of the nodes that come above the inserted node in the tree ( starting from the parent ,right upto the root ) is to be checked. The function &lsquo;self_bal&rsquo; invoked &lsquo;balance()&rsquo; which performs the further  tasks. Again, since a newly created tree is always balanced and since parent of the root points to NULL , the function &lsquo;balance()&rsquo; should not be called if the newly inserted node is the root itself.</p>

<p><strong>balance() </strong>:   Invokes the function bal_fac() and checks if the balance factor is equal to +or- 2 . If yes , calls the appropriate rotate function.</p>

<p><strong>bal_fac()   :</strong> Finds out the balance factor for each node.</p>

<p><strong>rotate()     :</strong> Here rotate() is the just the cohesive name for the two types of rotate functions . According to the balance factor , the appropriate &lsquo;rotate&rsquo; functions are called. We will discuss them in detail later.</p>

<p>The pictorial representation of &lsquo;delete()&rsquo; would be no different.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/delete.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/delete.png?w=300" alt="" /></a></p>

<p>By now you would have understood that the central aspect in building up the whole Avl tree is the rotate() function, but before we get into implementing the &lsquo;rotate()&rsquo; function , its of prime importance that we give a little more thought into implementing the &lsquo;delete()&rsquo; function in the Avl tree. As mentioned above , there is just a minor change that needs to be made , due to the self balancing nature of the Avl tree.</p>

<p>While performing a &lsquo;delete()&rsquo; function in a normal BST, we need to look into 5 different cases of how a particular node could be deleted and replaced with another one. Just peeping into them:</p>

<p>1)The victim node being a leaf      node.</p>

<p>2)The victim node having a right    child.</p>

<p>2.1) The victim node having a right     child with a left subtree.</p>

<p>2.2) The victim node having a right     child with no left subtree.</p>

<p>3)The victim node not having a  right child.</p>

<p>3.1) The victim node having a left  child with a right subtree.</p>

<p>3.2) The victim node having a   left-child with no right subtree.</p>

<p>Certainly , from what we have discussed until now, its clear that one of these conditions never happens. You might have guessed it by now.</p>

<p>Case 3.1) would never happen in an Avl tree. This could be explained with the following figure.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/case3-11.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/case3-11.png?w=252" alt="" /></a></p>

<p>Consider you want to delete the node &lsquo;10&rsquo; after adding &lsquo;9&rsquo; to the tree , but adding &lsquo;9&rsquo; to the tree would leave it unbalanced.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/case3.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/case3.png?w=250" alt="" /></a></p>

<p>Hence the tree will be rotated so that it becomes balanced ( how?, we will come to know shortly) before you could delete &lsquo;10&rsquo; . Hence there will never be a case of a victim node have a &lsquo;left child with a right subtree&rsquo; and does not have a right child of its own.</p>

<p>Now , its time that we move into the  in the creation of an Avl Tree, the &lsquo;rotate() &rsquo; function.</p>

<p><strong>Rotation</strong> ,as mentioned ,<strong>follows up a deletion from or an insertion into an Avl tree</strong> in such a way that it destroys the balanced nature of the Tree.</p>

<p>There are 4 kinds of rotation which are implemented using 2 different rotation functions.</p>

<p>Its crucial at this stage that the following points are understood.</p>

<p><em>Balance factor of a node = +2 implies that the node ( and ultimately the tree) is unbalanced because of  the left subtree of the node and there will be one right rotation for sure.</em></p>

<p><em>Balance factor of a node = -2 implies that the node ( and ultimately the tree) is unbalanced because of the right subtree of the node and there will be one left rotation for sure.</em></p>

<p><em>Whether a single rotation needs to be done or whether the tree needs to be rotated twice depends upon the balance factor of the child of the root of the subtree that is unbalanced. You needn&rsquo;t scratch your head on this , stuffs that follow would lighten up things.</em></p>

<p>Let &lsquo;point&rsquo; be the root of the subtree which has made the tree go out of balance . The 4 kinds of rotation are:</p>

<p>1)<strong>left  – left rotation:</strong> If balance factor(BF) of point is 2 and the BF of the left child is > 0 , then a single &lsquo;right&rsquo; rotation would do it for you.</p>

<p>2)<strong>left  –  right rotation:</strong> If BF of point is 2 and the BF of the left child is &lt; 0 , then a    &lsquo;left&rsquo; rotation followed by a &lsquo;right&rsquo; rotation would do it for you.</p>

<p>3<strong>)right – left rotation:</strong> If BF of point is -2 and the BF of the left child is > 0 , then a &lsquo;right&rsquo; rotation followed by a &lsquo;left&rsquo; rotation makes the tree balanced.</p>

<p>4)<strong>right – right rotation:</strong> If BF of point is -2 and the BF of the left child is &lt; 0  , then a single &lsquo;left&rsquo; rotation would be enough.</p>

<p>We will discuss rotation which happens as a result of the tree being unbalanced after an insertion or a deletion has been performed. The &lsquo;rotation&rsquo; function is independent of whether the previous function was a deletion or an insertion , it depends only on the current structure of the tree.</p>

<p><em><strong>Left-Right Rotation  &amp;   Left-Left Rotation</strong></em></p>

<p>Consider the figure :</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/lr1.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/lr1.png?w=231" alt="" /></a></p>

<p><em>Here the point of imbalance is &lsquo;23&rsquo; and the reason for imbalance is the left subtree of &lsquo;23&rsquo;. </em>Hence performing a &lsquo;right&rsquo; rotation is essential . Now the left child of &lsquo;23&rsquo; has a BF of -1 ( &lt; 0 ) . Hence a left rotation also needs to be performed. This leads to a left-right rotation .</p>

<p>left rotation : Left rotation is performed by invoking the rotate_left() function. The two parameters that are to passed to the function are &lsquo;root&rsquo; and &lsquo;pivot&rsquo; .</p>

<p>Root &mdash;&ndash;> point of imbalance , I.e  &lsquo;17&rsquo;</p>

<p>Pivot &mdash;&ndash;> right-child of the point of imbalance I.e &lsquo;19&rsquo;.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/lr2.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/lr2.png?w=231" alt="" /></a></p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/lr3.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/lr3.png?w=278" alt="" /></a></p>

<p>The left rotation has been performed.</p>

<p>Now our problem has been reduced to performing a left-left rotation , you could see that from the figure .That is ,we need to perform a single &lsquo;right rotation&rsquo;:</p>

<p>right rotation : The right rotation is performed by invoking the rotate_right() function. The two parameters would be :</p>

<p>Root &mdash;&ndash;> point of imbalance : I.e 23</p>

<p>Pivot &mdash;&ndash;> left-child of the point of imbalance I.e &lsquo;19&rsquo;.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/lr4.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/lr4.png?w=278" alt="" /></a></p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/l11.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/l11.png?w=258" alt="" /></a></p>

<p>The right rotation also has been performed. Now you may have a look at the tree and would find out that its balanced .</p>

<p><em><strong>Right-Left Rotation &amp;  Right-Right Rotation.</strong></em></p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/lf11.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/lf11.png?w=283" alt="" /></a></p>

<p>Consider the figure above :</p>

<p><em>Here the point of imbalance is &lsquo;17&rsquo; and the reason for imbalance is the right subtree of &lsquo;17&rsquo;. </em>Hence performing a &lsquo;left&rsquo; rotation is essential . Now the right child of &lsquo;17&rsquo; has a BF of 1( > 0 ) . Hence a &lsquo;right&rsquo; rotation also needs to be performed. This leads to a right-left rotation .</p>

<p>right rotation : right rotation, as mentioned above is performed by invoking the rotate_right() function. The two parameters that are to passed to the function are &lsquo;root&rsquo; and &lsquo;pivot&rsquo; .</p>

<p>Root &mdash;&ndash;> point of imbalance , I.e  &lsquo;23&rsquo;</p>

<p>Pivot &mdash;&ndash;> left-child of the point of imbalance I.e &lsquo;19&rsquo;.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/lf21.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/lf21.png?w=283" alt="" /></a></p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/lr31.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/lr31.png?w=300" alt="" /></a></p>

<p>The right rotation has been performed.</p>

<p>Now our problem has been reduced to performing a right-right rotation .That is ,we need to perform a single &lsquo;left rotation&rsquo;:</p>

<p>left rotation : We have seen that left rotation is performed by invoking the rotate_left() function. The two parameters would be :</p>

<p>Root &mdash;&ndash;> point of imbalance : I.e &lsquo;17&rsquo;</p>

<p>Pivot &mdash;&ndash;> right-child of the point of imbalance I.e &lsquo;23&rsquo;.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/lr41.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/lr41.png?w=300" alt="" /></a></p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/l12.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/l12.png?w=258" alt="" /></a></p>

<p>The left rotation also has been performed. The tree has been balanced .We have found out how a tree could be balanced through rotation.</p>

<p>There is another issue that we need to deal with while performing rotation. Two questions that we need to consider here are&hellip;</p>

<p><strong>1)What happens to the left node of the pivot during a left rotation.?</strong></p>

<p><strong>2)What happens to the right node of the pivot during the right rotation.?</strong></p>

<p>Consider the following figure .</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/nw.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/nw.png?w=195" alt="" /></a></p>

<p>The tree as you could see is unbalanced with the root (&lsquo;23&rsquo;) being the point of imbalance, the left subtree being the reason for the imbalance.. Since the BF of the left child of the root = -1 ( &lt; 0 ) , we need to perform a left – right rotation . I.e a left rotation followed by a right rotation . For performing the left rotation , the root is &lsquo;17&rsquo;  and the pivot is &lsquo;19&rsquo;. As you could see from the figure ,the left child of the pivot is marked &lsquo;L&rsquo; . Our question is what exactly happens to this &lsquo;L&rsquo; after the left rotation has been performed. ? The answer is right there in our next figure .</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/nw2.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/nw2.png?w=255" alt="" /></a></p>

<p>L has become the right child of &lsquo;17 &rsquo; . To be more precise <strong>,after a left rotation, &lsquo;L&rsquo;( the left child of the pivot) has become the &lsquo;right child&rsquo; of the node which was the parent of the &lsquo;pivot&rsquo; before the rotation was performed.</strong></p>

<p>As you could see, the tree still remains unbalanced as we have not performed the 2nd phase of our left-right rotation . We perform the right rotation and make the tree balanced .</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/nw3.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/nw3.png?w=255" alt="" /></a></p>

<p>I think , by now you would be able to guess out the solution for the second question that we had asked .</p>

<p>What happens to the right node of the pivot during the right rotation.?</p>

<p>The answer is certain , this is exactly the complement of what happens after a left rotation that we have just seen . <strong>After performing a right rotation , the right child of the pivot becomes the left child of the node that was its parent before the rotation was performed</strong>.</p>

<p>Here , I have tried and dealt with almost all issues that come up in the implementation of an Avl tree. You could download the complete source code<a href="http://github.com/sunilkumarn/Avl_Tree"> here</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/04/280">GNU Make</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-04T00:05:22+05:30" pubdate data-updated="true">Oct 4<span>th</span>, 2010</time>
        
         | <a href="/2010/10/04/280#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The make utility determines which pieces of the program needs to be recompiled and issues instructions to recompile them.GNU make is the most popular make available. Lets get into the working of make with a simple example but please do read <a href="http://sunilkumarn.wordpress.com/2010/10/03/swigsimplified-wrapper-and-interface-generator/">THIS</a> before moving into further details.</p>

<p>By reading that, you would have understood that our ultimate aim is to produce a file &lsquo;_avl.so&rsquo; so that the C module &lsquo;avl.c&rsquo; could be extended into Python.
Lets check what exactly do we need to do here.</p>

<p>We begin with 2 files namely &lsquo;avl.c&rsquo; and &lsquo;avl.i&rsquo;. We need to create a wrapper file at first . This is done by:</p>

<p><strong>$: swig -python avl.i</strong></p>

<p>Next what we need to do is that we need to create 2 object files for the respective C files- i.e we need to produce &lsquo;avl.o&rsquo; and &lsquo;avl_wrap.o&rsquo; from &lsquo;avl.c&rsquo; and &lsquo;avl_wrap.c&rsquo; respectively.
We do this by:</p>

<p><strong>$: gcc -c avl.c avl_wrap.c -I /usr/include/python2.5/</strong></p>

<p>The last and final step is to create &lsquo;_avl.so&rsquo; from the 2 object files.</p>

<p><strong>$: ld -shared avl.o avl_wrap.o -o _avl.so </strong></p>

<p>The dependencies and actions are quite clear now.
<a href="http://sunilkumarn.files.wordpress.com/2010/10/make.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/make.png" alt="" /></a></p>

<p>Typing in these commands time and again would be a tedious and ineffective job for anyone. We could automate the whole process by writing a file called Makefile and use the &lsquo;make&rsquo; utility.</p>

<p>The Makefile for performing the above steps would be as follows:</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/makefile3.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/makefile3.png?w=300" alt="" /></a></p>

<p>A Makefile has the following format.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/new3.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/new3.png?w=300" alt="" /></a></p>

<p>Its important to note that the &lsquo;ACTIONS&rsquo; line begins with a TAB as it is a part of the syntax of a Makefile. Anything other than TAB would be harmful.</p>

<p>Lets check out how things work out.</p>

<p><strong>$: make</strong></p>

<p>This would cause GNU make to start executing the commands in Makefile.GNU make starts from the very beginning of the Makefile. The first set of &lsquo;TARGET-DEPENDENCIES-ACTIONS are checked in.</p>

<p>The TARGET is &lsquo;_avl.so&rsquo; : The DEPENDENCIES are &lsquo;avl.o and avl_wrap.o&rsquo; and the ACTION that needs to be performed is</p>

<p><strong>ld -shared avl.o avl_wrap.o -o _avl.so</strong></p>

<p>But at present &lsquo;avl.o&rsquo; and &lsquo;avl_wrap.o&rsquo; are not available. To Generate them the next set of the Makefile is to be checked. The same problem exists there as well . Hence the 3rd set in the Makefile is reached where the DEPENDENCY is &lsquo;avl.i&rsquo; which exists at present. Hence the action</p>

<p><strong>swig -python avl.i
</strong>
is executed , the target &lsquo;avl_wrap.c&rsquo; is generated .
Now the second set in the Makefile can be compiled followed by the compilation of the first set. The procedure that takes place here is recursive .All the three actions are executed , the TARGETS are generated from the ACTIONS and DEPENDENCIES and finally we obtain &lsquo;_avl.so&rsquo;.</p>

<p>You could see another line in the Makefile that has not been mentioned upto now.
<strong>make remove</strong>
make remove is the TARGET and the ACTION that needs to be performed is
<strong>rm avl.o avl_wrap.o avl.py _avl.so avl_wrap.c avl.pyc</strong></p>

<p><strong>$: make remove</strong></p>

<p>will remove all the unnecessary files in the directory when you are planning to start from the beginning.</p>

<p>If you would like to have a test on the intelligence of &lsquo;make&rsquo; , you would be pretty surprised.</p>

<p>Lets deal that case with an example as well.</p>

<p>DO:</p>

<p><strong><strong>$:  swig -python avl.i</strong></strong></p>

<p>We have executed the first command manually.
Now do:</p>

<p><strong>$: make</strong></p>

<p>and you will find that make executes only the other two commands that is included in the Makefile.
This again shows the recursive nature of the make process. The Makefile is read from the top. On reaching the second set , GNU make realizes that both the dependencies &lsquo;avl.c&rsquo; and &lsquo;avl_wrap.c&rsquo; are available and executes the ACTION to produce the TARGET &lsquo;avl.o&rsquo; and &lsquo;avl_wrap.o&rsquo;.</p>

<p>Now once again do
<strong>$: make</strong></p>

<p>You would get a message as follows:
<strong>make: `_avl.so&#8217; is up to date.</strong></p>

<p>This again brings to the fort-light the power of make. The final target &lsquo;_avl.so&rsquo; has been found to be &lsquo;up to date&rsquo; and hence there is no question of having to execute the commands in the Makefile . GNU make, <strong>Richard Stallman and Rolland Mcgrath&rsquo;s creation</strong>, has recognized this.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/03/swigsimplified-wrapper-and-interface-generator">SWIG(Simplified Wrapper and Interface Generator).</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-03T21:02:07+05:30" pubdate data-updated="true">Oct 3<span>rd</span>, 2010</time>
        
         | <a href="/2010/10/03/swigsimplified-wrapper-and-interface-generator#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><pre><code>Scripting languages like python presents a lot of ease to the programmer while coding , but the fact remains that there are certain tasks that would screw you up when attempted in Python. So the coding is done in a more flexible language like C and the modules are imported in Python. **SWIG** is a tool that is used for extending your C programs into python and make the functions callable from Python.
</code></pre>

<p>Here we discuss how to import a C module into Python using SWIG.
Installing SWIG in your system ,if you haven&rsquo;t already, is the first task.</p>

<p><strong>$:apt-get install swig</strong></p>

<p>would do that for you.</p>

<p>Now its better you create a directory for the entire purpose and setup yourself within it.
Consider you have a C file ,<strong>avl.c</strong> , as our example<em> (Avl is a height balanced Tree ,avl.c is an implementation of such a tree.</em>) You could download the source code for avl.c <a href="http://github.com/sunilkumarn/Avl_Tree">here</a>.</p>

<p>Our first step is to create an interface file &lsquo;<strong>avl.i</strong>&rsquo; for setting up the interface. &lsquo;avl.i &rsquo; consists of the declarations of the various functions and global variables that are used in the file &lsquo;avl.c&rsquo; and are prefixed with &lsquo;extern&rsquo;.</p>

<p>`%module avl</p>

<p>%{</p>

<pre><code>extern struct node *root;

    extern struct node *p;
</code></pre>

<p>%}</p>

<p>extern void insert(struct node* move,int item);</p>

<p>&hellip;
&hellip;
&hellip;
&hellip;
`
The &lsquo;avl.i &rsquo; file would like as above:
Now we have two files in our directory ,</p>

<p>avl.c   &amp;   avl.i</p>

<p>This is all that we have to code for the task of extending a C module in Python. Now its all about SWIG.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/10/swig.png"><img src="http://sunilkumarn.files.wordpress.com/2010/10/swig.png" alt="" /></a>
Lets move further: Do the following.</p>

<p><strong>$:swig -python avl.i
</strong>
now have have a look into your directory and you will find two more files there .</p>

<p>avl.py  &amp;   avl_wrap.c    <br/>
<strong>avl_wrap.c</strong> is the wrapper file that has been created for the purpose of extension . Wrapper functions act as a glue layer between languages.</p>

<p><strong>$: gcc -c avl.c avl_wrap.c -I /usr/include/python2.5/</strong></p>

<p>You could now see 2 more files present in your directory.
avl.o   &amp;     avl_wrap.o</p>

<p>These two are the object files that have been created for avl.c and avl_wrap.c respectively.</p>

<p><strong>$: ld -shared avl.o avl_wrap.o -o _avl.so</strong></p>

<p>This is the last thing you need to do before you could use start using your C module in Python.
Check your directory and you could see a new file ,<strong> &lsquo;_avl.so&rsquo;</strong>. This is the shared object file that has been created .
If you create a make file for these , then obviously you wont have to go doing these tasks repeatedly.
Now ,the python module corresponding to the C module avl.c has been created which means that now you could start using it.</p>

<p><strong>$: python</strong></p>

<blockquote><blockquote><blockquote><p>import avl
avl.my_insert(10)
avl.my_insert(20)
avl.traverse(1)</p></blockquote></blockquote></blockquote>

<p>The source code can be downloaded <a href="http://github.com/sunilkumarn/Extending_into_python">here.
</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/09/25/evaluation-of-scheme-in-python">Evaluation of Scheme in Python</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-25T19:13:22+05:30" pubdate data-updated="true">Sep 25<span>th</span>, 2010</time>
        
         | <a href="/2010/09/25/evaluation-of-scheme-in-python#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Those who have ever gone through the SICP ( Structure and interpretation of computer programs) , would have come across the implementation of a Metacircular evaluator ( an evaluator written in a language that it evaluates) for scheme in the 4rth Chapter.
<a href="http://sunilkumarn.files.wordpress.com/2010/09/cover.jpg"><img src="http://sunilkumarn.files.wordpress.com/2010/09/cover.jpg?w=207" alt="" /></a></p>

<p>Motivated by that , and drawing ideas from the <strong>wizard book</strong> , an evaluator for Scheme is created in Python, so that Scheme statements evaluated in Python.</p>

<p>The creation of a metacircular evaluator for scheme contains prominently of two steps:</p>

<pre><code>     1)  Eval:   To evaluate a combination (a compound expression other than a special form), evaluate the subexpressions and then apply the value of the operator subexpression to the values of the operand subexpressions. 
    2)  Apply :  To apply a compound procedure to a set of arguments, evaluate the body of the procedure in a new environment. 
</code></pre>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/09/image-02.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/image-02.png?w=300" alt="" /></a></p>

<p><em><strong>Implementation of the Evaluator in Python:</strong></em></p>

<p>Before getting into the creation and implementation details of the evaluator , please read <a href="http://sunilkumarn.wordpress.com/2010/09/25/concept-and-creation-of-environment/">this</a>.
Now that you have got an idea about the concepts of environment , lets get into further details of creation of the evaluator.</p>

<p>The first process is basically to parse the user Input and use it in a way so as to evaluate it. After parsing ,the user input is provided to the function gravity().This particular function performs the task of classifying the user input and route them to appropriate functions. This is similar to &lsquo;eval&rsquo; in the scheme metacircular evaluator implemented in SICP.
According to the user input , the appropriate functions are performed.
Different functions implemented in the evaluator.</p>

<p><strong>evaluate():</strong>
This function could be compared with the &lsquo;apply&rsquo; procedure implemented in SICP. The function checks for different operator and its corresponding operands. The operator is applied to the operands and the result returned.</p>

<p><strong>opdet():</strong>
The function is called from &lsquo;evaluate()&rsquo; , it takes in a list and returns the operator that has to be applied to the operands.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/09/evaluate.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/evaluate.png?w=300" alt="" /></a></p>

<p>If a simple expression is provided just to perform basic arithmetic and logical operations , only these two functions are invoked after the gravity () function and we obtain the result. The situation, as is obvious would be a little different when relatively complex tasks are give ( such a processing of an &lsquo;if&rsquo; statement , a function , an assignment operation, a recursive function and so on.</p>

<p>Processing of an &lsquo;if&rsquo; statement involves invoking many more functions.</p>

<p><strong>if_begin_eval():</strong>
This function involves the presence of any variables involved in the &lsquo;if&rsquo; statement and fetches the value of such variables from the environment.</p>

<p><strong>if_eval() :</strong>
This particular function is used to evaluate the &lsquo;predicate &rsquo; of the &lsquo;if&rsquo; statement and returns the result of the &lsquo;if&rsquo; statement. The function invokes the &lsquo;evaluate()&rsquo; function and would process the entire &lsquo;if&rsquo; statement according to the value returned by &lsquo;evaluate()&rsquo; .
If a simple &lsquo;if&rsquo; statement&#8217;
( if ( > 4 5 ) 4 5 ) is inputted:
if_eval() would pass the predicate part ( >  4 5 ) to &lsquo;evaluate()&rsquo; and process the if statement according to the returned value. Here the value returned by &lsquo;evaluate()&rsquo; would be 0, since the condition ( 4 > 5 ) is not true. The value returned by the &lsquo;if_eval()&rsquo; would be 5.</p>

<p><strong>if_cons_alt(): </strong>
The function evaluates the consequent and alternative of the &lsquo;if&rsquo; condition&#8217;. A separate function for the process would be specially helpful when the if statement consists of larger expressions and values.
The function would return back a 2 element list of the final values obtained after evaluation of the consequent and alternative.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/09/if.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/if.png?w=300" alt="" /></a></p>

<p>Evaluation of procedures would take us through a different path. We need functions that can extract, evaluate and execute a function. We also need a function to test whether the inputted procedure is recursive or non-recursive.</p>

<p><strong>exec_call():</strong>
Checks whether the function is a simple function of the sort :
( define ( lambda ( square ( x ) ( * x  x ) ) )  non-recursive
or of the sort:
( define ( lambda ( fact ( x ) ( if ( = x 1 ) 1 ( * x fac ( &ndash; x 1 ) ) ) ) ) )   recursive :
executes the procedure if non-recursive.</p>

<p><strong>extract_funcbody():</strong>
extracts the body of the function. Passes the body of the function to evaluate_funcbody .</p>

<p><strong>evaluate_funcbody():</strong>
Fetches the value of the variables in the function body and returns back the function body to extract_funcbody(). This function is invoked only when the procedure is non-recursive.</p>

<p><strong>exec_func_body():</strong>
Fetch the value of the variables in the function body . This function is invoked only when the inputted procedure is recursive.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/09/func1.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/func1.png" alt="" /></a></p>

<p><strong><em>Use of the module ops().</em></strong>
You would see a module named &lsquo; ops&rsquo; being imported. This module consists of certain functions that can be performed on lists. The module is imported so as to get a feel of the way programming is done in scheme , any operation on lists can be performed on lists using 5 basic functions. The attempt has been made to stick to the combination of these basic operations rather than using the full functionality of Python.</p>

<p>The source code of the project can be obtained <a href="http://github.com/sunilkumarn/MetacircularEvaluator">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/09/25/concept-and-creation-of-environment">Concept and Creation of Environment</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-25T19:07:05+05:30" pubdate data-updated="true">Sep 25<span>th</span>, 2010</time>
        
         | <a href="/2010/09/25/concept-and-creation-of-environment#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the most important thing you need to grasp while doing a project on interpreters and evaluator is the idea of an environment. Within the program the environment is a collection of the names(whether variables or functions) and its corresponding values. While using such names you will need an environment where you can store the value of those names so that you could fetch it for further use. While implementing the evaluator for scheme in python , the concept of environment was implemented using <strong>associative arrays</strong> in python. 3 dictionaries were used to implement the concept of environment. Lets go through a bit of details on the creation and use of environments.</p>

<p>Consider writing the scheme statements:</p>

<p>scheme>>>( define n 7 )
scheme>>>( define s 6 )
scheme>>>( if ( > n s ) n s )</p>

<p>In our &lsquo;if&rsquo; statement we have not specified the exact value , but instead we have used variables. The question comes then that from where do we retrieve the values of those variables.
The answer is simple: &lsquo;Here the variables are global variables and are accessible from anywhere within the program&rsquo;. Hence we need create a dictionary which consists of &lsquo;n&rsquo; and &rsquo;s&#8217; as its keys and their values as the values of the dictionary. This dictionary is created when the statement &lsquo;define ( not followed by a  parenthesis) is inputted.</p>

<p>1)<strong>dict</strong>={&rsquo;s&#8217;:&lsquo;7&rsquo;,&lsquo;n&rsquo;:&lsquo;6&rsquo;}</p>

<p>Obviously we cannot use this dictionary for all our purpose. We also need a dictionary where we could store variables and values that are local to a function. We have created another dictionary for this very purpose .</p>

<p>Consider the following:
scheme>>>( define ( sq ( lambda ( x ) ( * x x ) ) )       &mdash;&mdash;&ndash;>      statement 1
scheme>>>( sq 4 )                       &mdash;&mdash;&ndash;>     statement 2</p>

<p>When the second statement is executed ,a dictionary &lsquo;local_dict&rsquo; is created where this value 4 is associated with the variable &lsquo;x&rsquo;.</p>

<p>2)<strong>local_dict</strong>={&lsquo;x&rsquo;:&lsquo;4&rsquo;}</p>

<p>We use the 3rd dictionary for associating a function with its body. When the &lsquo;statement 1&rsquo; above is inputted , a dictionary &lsquo;func_dict&rsquo; is created which contains the &lsquo;function name&rsquo; as its key and the &lsquo;body&rsquo; as its value.</p>

<p>3)<strong>func_dict</strong>={&lsquo;sq&rsquo;,&lsquo;(  lambda ( x ) ( * x x ) )&rsquo; }</p>

<p>We have functions &lsquo;<strong>create_env ()&rsquo;</strong> and <strong>&lsquo;create_localenv()</strong>&rsquo; for creating the first and third dictionaries that we have mentioned above. The second dictionary is created within the function <strong>&lsquo;exec_call()</strong>&rsquo; where the processing of each function is started. Hence its appropriate to create the dictionary needed only for the local use of that function within exec_call().</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/09/24/analyzing-the-tinypy-virtual-machine">Analyzing the Tinypy Virtual Machine</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-24T02:22:00+05:30" pubdate data-updated="true">Sep 24<span>th</span>, 2010</time>
        
         | <a href="/2010/09/24/analyzing-the-tinypy-virtual-machine#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The major task in tinypy is to analyze the working of the virtual machine. Analyzing and understanding its source code is, obviously, the major challenge that is faced. The code itself is not well arranged and the lack of proper documentation makes the challenge even bigger. Proper use of the GNU debugger, &lsquo;gdb&rsquo;, and the indexing tool, Ctags makes the process of analysis of the VM a lot simpler. Perhaps the best way to understand the working of the VM is to use the VM to execute the byte code of a simple python program and see and understand the actual flow of control. Here a sample program &lsquo;sample.py&rsquo; is used:</p>

<p><code>def add(a,b):
c = a + b
return(c)
print(add(1,9))</code></p>

<p>Note that the use of the parentheses for built-in functions too is a part of the syntax in TinyPy. Obtaining sample.tpc is explained <a href="http://sunilkumarn.wordpress.com/2010/09/23/an-overview-of-tinypy/">here.</a></p>

<p>**cc vmmain.c -1m</p>

<pre><code>        ./a.out sample.tpc   **
</code></pre>

<p>gives you the output:
<em>10</em></p>

<p>Understanding the flow of control for this program would give an idea of the working of a segment of the virtual machine.
Each time the VM is invoked, a new instance of the VM is created .
<strong>tp_vm *tp =tp_init(argc,argv);</strong></p>

<p>The key point to be understood in the analysis of VM is that each object in tinypy is stored as a union in the C API.
Lets get into the details:<strong> tp_obj</strong> is the tinypy&rsquo;s object representation.</p>

<p><code>typedef union tp_obj  {
int type;
tp_number_ number;
struct{int type;int *data;}gci;
tp_string_ string;
tp_dict_ dict;
tp_list_ list;
tp_fnc_ fnc;
tp_data_ data;
} tp_obj;
</code>
The union tp_obj with its fields are shown. The field <strong>&lsquo;type&rsquo;</strong> of the union indicates the type of the object. A type value of 1 indicates that a number is being used, type = 2 indicates object is a string and type = 4 indicates a list. In our sample program, our objective is to add two numbers &lsquo;a&rsquo; and &lsquo;b&rsquo; and print their output. A function in the virtual machine <strong>&lsquo;tp_add&rsquo;</strong> does the job of adding two arguments that is passed to the function as input. The arguments could be numbers, strings or lists. Lets analyze the function &lsquo;tp_add&rsquo;.</p>

<p><strong>tp_obj tp_add(TP,tp_obj a,tp_obj b)
</strong>
The Function definition of &lsquo;tp_add&rsquo; contains three arguments:
• <em>TP &ndash;> the VM instance
• tp_obj a &ndash;> the union variable representing the object &lsquo;a&rsquo; in the sample program
• tp_obj b &ndash;> the union variable representing the object &lsquo;b&rsquo; in the sample program
_
Within the function<strong> tp_add</strong>, the type of the two objects are checked and the appropriate function is performed. In our example, two numbers are to be added. As we mentioned above, &lsquo;a&rsquo; and &lsquo;b&rsquo; are stored as unions and the union contains fields for types such as number, strings, lists etc. We access the field **tp_number</em><strong> in the union &lsquo;a&rsquo; as &lsquo;</strong>a.number&rsquo;<strong>. </strong>&lsquo;number&rsquo;<strong> is a variable of the structure </strong>tp_number<em><strong> which contains a variable </strong>&lsquo;val<strong>&rsquo; that stores the exact value of the number . Therefore </strong>a.number.val<strong> would give you the actual object . Analyzing the addition of strings would be interesting as well. &lsquo;</strong>a.string&rsquo;<strong> would give you the union which represents the string object. The union</strong> tp_obj<strong> contains a field </strong>tp_string</em>** which is a structure and includes the pointer that points to the address where the string &lsquo;a&rsquo; is stored. The structure of tp_string_:</p>

<p><code>typedef struct tp_string_ {
int type;
struct tp_string_ info*;
char const *val;
int len;
}  tp_string_;</code></p>

<p>An idea about the manipulation of lists would do no harm to our primary objective, the study of the working of the VM. Consider two simple lists in python :
a = [1,2,3] , b = [4,5,6]</p>

<p>Again we start from tp_add which needs us to go back to our function. The VM uses a function <strong>&lsquo;tp_extend</strong>&rsquo; which returns a union that contains the new (extended) list. You would see that the value of the field &lsquo;type&rsquo; of the union that is returned would be 4 which indicates a list. Access the field &lsquo;list&rsquo; as <strong>&lsquo;a.list&rsquo;</strong>. <strong>&lsquo;list</strong>&rsquo; is a structure variable that includes a pointer <strong>*val </strong>that points to another structure &lsquo;<strong>_tp_list&rsquo;:</strong></p>

<p><code>typedef struct _tp_list {
int gci;
tp_obj *items;
int len;
int alloc;
} _tp_list;</code></p>

<p>The pointer <strong>*items</strong> as you could see is of type tp_obj and de-referencing it would give you the union tp_obj. This union contains a single element of the list. Starting from the function tp_add:</p>

<p><strong>*r.list.val &ndash;> items
</strong>
would give you the union mentioned above. Accessing the field &lsquo;<strong>val</strong>&rsquo; of the field<strong> &lsquo;number</strong>&rsquo; (variable of the structure tp_list_) of the union would give you the element of the list. Now , the obvious question is how do we obtain the next element of the list. For this you need to have some idea about the storage of unions.</p>

<p><strong>r.list.val &ndash;> items</strong></p>

<p>would give you the address of the union. Suppose the address be &lsquo;<strong>0x96ca048&rsquo;</strong> . Now to obtain the union which contains the next element of the list, you need to add the address of the current union with the size taken by each union (sizeof(union)).
<em>Union containing the next element of the list = Address of the current union + size of each union</em>. For example :
<strong>r.list.val &ndash;> items = 0x96ca048 + 10</strong>
would give you the union that stores the next element of the list . The size of the union is 10, in hexadecimal = 16 bytes.
<a href="http://sunilkumarn.files.wordpress.com/2010/09/image-1.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/image-1.png?w=300" alt="" /></a></p>

<p>The path of <strong>tp_add</strong> can be traced using the &lsquo;bt&rsquo; option in gdb. The path of the function tp_add is as follows:
<a href="http://sunilkumarn.files.wordpress.com/2010/09/image-2.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/image-2.png?w=245" alt="" /></a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/09/24/an-overview-of-tinypy">An Overview of TinyPy</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-24T02:19:32+05:30" pubdate data-updated="true">Sep 24<span>th</span>, 2010</time>
        
         | <a href="/2010/09/24/an-overview-of-tinypy#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>TinyPython is a minimalist implementation of Python in 64K code. It is a parser and byte-code compiler written in TinyPython itself. It is also fully bootstrapped in the sense that initially, TinyPython converts a Python script (.py) into a special TinyPy byte-code format (.tpc), and this generated code is then passed into a  subset of the TinyPython source code called the Virtual Machine, where the actual execution takes place.</p>

<p>One can even extend the idea that if the VM is compiled into a low-level format adaptable to a particular micro controller, then the VM will reside inside that chip, and any .tpc files can be downloaded into the chip as its input.</p>

<p>As outlined above, TinyPy comprises of two phases: the byte-code generation, and the execution of the byte-code in the TinyPy Virtual Machine. Out of these, the first phase will not be mentioned here.</p>

<p><em><strong>Building Up</strong></em>
The TinyPython source code used was downloaded from <a href="http://code.google.com/p/tinypy/downloads/list">here</a>. Initially, the file listing will look like the following figure.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/09/image-01.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/image-01.png?w=300" alt="" /></a></p>

<p>You can find that the &lsquo;build&rsquo; folder will be empty. The &lsquo;doc&rsquo;, &lsquo;examples&rsquo; and &lsquo;modules&rsquo; folder may or may not contain any documents, Python scripts and batteries (or modules) respectively, depending on the downloaded package. The LICENSE.txt and README.txt are self-explanatory names. The CHANGES.txt contain a record of all the changes that the author of TinyPy thought of making in the source code at some point. The ROADMAP.txt gives a brief description of the features of TinyPy, and an idea about the future developments to be implemented. The &lsquo;setup.py&rsquo; contains the initial code to build the TinyPy from scratch. At the terminal, type as follows:
<strong>python setup.py linux
</strong>
It is implied that you need a Python interpreter available in your system. The &lsquo;linux&rsquo; option is to specify that the code will be compiled so as to make it work in a Linux environment. After running this command, a new executable &lsquo;tinypy&rsquo; will appear in the &lsquo;build&rsquo; folder as shown.</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/09/image-3.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/image-3.png?w=300" alt="" /></a></p>

<p>To fully bootstrap and test TinyPy, give the command as,
<strong>python setup.py linux boot</strong></p>

<p>Now, in the &lsquo;tinypy&rsquo; folder shown in the above figure, two new executables, &lsquo;tinypy&rsquo; and &lsquo;vm&rsquo; will appear, which are the TinyPy parser, and Virtual Machine respectively. It can be noticed that all the .pyc files for the corresponding .py files have been generated by the Python interpreter. In addition to that, some test scrips &ndash; named as Temp &ndash; will be invoked too. The most interesting thing will be the presence of new <strong>.tpc</strong> files for some of the initial <strong>.py</strong> files. The general usage and some options available are listed below.</p>

<p>python setup.py command [option] [module]
• 64 k &ndash; build a a64k version of TinyPy source code
• blob &ndash; build a single tinypy.c and tinypy.h</p>

<p>The tinypy folder will now have the following contents: Out of these, the &lsquo;py2bc.py&rsquo; script is used to convert a user-generated Python script into its corresponding .tpc file. The format will be:
 <strong>py2bc.py sample.py sample.tpc</strong></p>

<p>Here, tinypy_path is the path (relative to current position) of either the tinypy executable in the &lsquo;build&rsquo; folder, or the one in the &lsquo;tinypy&rsquo; folder. &lsquo;sample.py&rsquo; is the name of the user-script. &lsquo;sample.tpc&rsquo; is the name given for the byte-code converted file. Or you can simply give it as:
<strong>python py2bc.py sample.py sample.tpc</strong></p>

<p>Finally, the generated byte-code (.tpc) is to be passed into the VM for compilation and execution. Assuming the current directory as &lsquo;tinypy&rsquo; folder, it is done as:
<strong>vm sample.tpc
</strong>
Or logically,
<strong>gcc vmmain.c -lm ./a.out sample.tpc</strong></p>

<p>The &lsquo;vmmain.c&rsquo; will be present in the &lsquo;tinypy&rsquo; folder. It is the main function of the VM which runs and automatically links to all the other files necessary for the VM. It is necessary to link the math module too, hence the option &lsquo;-lm&rsquo;. And now the output is obtained and displayed. For a better picture, the files actually needed for VM are:</p>

<p><a href="http://sunilkumarn.files.wordpress.com/2010/09/image-4.png"><img src="http://sunilkumarn.files.wordpress.com/2010/09/image-4.png?w=300" alt="" /></a></p>

<p>Writing and compiling the code only accounts to half of the process. The other half is debugging and understanding the flow of control within the source code. To do that, make use of the GNU debugging tool, &lsquo;gdb&rsquo;.
<strong>gcc -g vmmain.c -lm gdb ./a.out</strong></p>

<p>Inside the &lsquo;gdb&rsquo;, you can set breakpoint for any function. Then run the process for the byte-code you need. Here, &lsquo;sample.tpc&rsquo; is used as example.</p>

<p><strong>(gdb) run sample.tpc OR r sample.tpc</strong></p>

<p>Another essential tool will be &lsquo;ctags&rsquo;. After its installed, go to the &lsquo;tinypy&rsquo; folder and build the tag stack as follows:</p>

<p><strong>ctags <em>.c </em>.h</strong></p>

<p>You can see that a new file named &lsquo;tags&rsquo; is now available. Now when you are inside a .c or a.h file, you can use &lsquo;ctrl + ]&rsquo; and &lsquo;ctrl + T&rsquo; to jump back and forth between cross references spanning different files.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/09/23/find-the-endianity-of-your-processor">Find the Endianity of Your Processor:</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-23T03:23:24+05:30" pubdate data-updated="true">Sep 23<span>rd</span>, 2010</time>
        
         | <a href="/2010/09/23/find-the-endianity-of-your-processor#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Your processors can be of two types:
1)<em>Little Endian</em> : Little Endian means that the low-order byte of the number is stored in memory at the lowest address.For example, a two byte short int would be stored in memory as:
<strong>Base address + 0 : Byte 1
Base address + 1:  Byte 0</strong></p>

<p>2)<em>Big Endian</em> : &lsquo;Big Endian means that the high-order byte of the number is stored in memory at the lowest address. The &#8216;short int&rsquo; above would be stored
<strong>Base address + 0 :  Byte 0
Base address + 1 :  Byte 1</strong></p>

<p>where Byte 0 and Byte 1 are the first and second  bytes of the short integer.</p>

<p>You could verify the endianity of your processors by writing a short and sweet C code as follows:</p>

<pre><code>        `{  
            unsigned char *p;

            short int i=0x1234;

            p=&amp;i;

            printf("%x\n",*p);

        }`
The result you obtain would show you the endianity of your processor.
</code></pre>

<p>Lets give a thought on what actually happens.</p>

<p>0x1234 is a hexadecimal number and is stored in a variable &lsquo;i&rsquo; of type short int ( occupies 2 bytes of memory space ).</p>

<p>Address of variable &lsquo;i&rsquo; is stored in a pointer of type unsigned char &lsquo;*p&rsquo; ( I.e &lsquo;p&rsquo; points to an object of type &lsquo;unsigned char&rsquo;).</p>

<p>Dereferencing the pointer p would result in the access of just a single byte . This obviously would be the lower of the two bytes. <strong>This shows the fact that accessing a memory location with a pointer is purely dependent on the type of the pointer and not on the type of the actual value stored in the address being accessed. </strong>Note that the types of the&#8217; pointer to the memory location&#8217; and the &lsquo;actual value being stored in the location&rsquo; differ.</p>

<p>You obtain the value that is stored in the lower byte of the two bytes that is allocated for the <strong>&lsquo;short integer</strong>&rsquo; with the use of a pointer of type &lsquo;<strong>unsigned char</strong>&rsquo; ( size = 1 byte). The value stored at the lower byte would indicate to you the endianity.</p>

<p>From our sample program,and from what we know about little and big endians , an output of 34 indicates that your processor is &lsquo;little endian&rsquo; and an output of 12 indicates that its big endian.</p>

<p>Just to mention &ndash; &lsquo;Intel x86&rsquo; processors are one common example for little endian processors whereas &lsquo;Motorola 6800&rsquo; is big endian.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/12/18/heroku-deployment-with-mongodb-database">Heroku Deployment With MongoDB Database</a>
      </li>
    
      <li class="post">
        <a href="/2013/09/01/migrating-from-wordpress-to-jekyll-in-ten-steps">Migrating From Wordpress to Jekyll in Ten Steps</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/07/node-js-event-emitters-and-listeners">Node.js: Event Emitters and Listeners</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/06/rails-admin-with-authlogic">Rails Admin With Authlogic</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/28/prototypal-inheritance-in-javascript">Prototypal Inheritance in Javascript</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/23/node-js-streams-and-pipes">Node.js: Streams and Pipes.</a>
      </li>
    
      <li class="post">
        <a href="/2013/05/21/mercury-the-wysiwyg-html-editor">Mercury: The WYSIWYG Html Editor</a>
      </li>
    
      <li class="post">
        <a href="/2013/05/19/delayed-jobs-in-rails-adding-custom-attributes">Delayed Jobs in Rails: Adding Custom Attributes</a>
      </li>
    
      <li class="post">
        <a href="/2011/12/18/git-a-brief-on-reverts-resets-merges-and-conflicts">Git Reset, Revert, Merge Conflicts and the Faulty Merge</a>
      </li>
    
      <li class="post">
        <a href="/2011/12/18/git-a-brief-on-reverts-resets-merges-and-conflicts-2">Git -> a Brief on Reverts, Resets, Merges and Conflicts.</a>
      </li>
    
  </ul>
</section>




<section class="googleplus">

<h1>
  <a href="http://github.com/sunilkumarn/"><img src="http://i835.photobucket.com/albums/zz277/sunilkumargec56/github_zpse87fc53d.jpg" width="40" height="40"></a>
  &nbsp; &nbsp;
  <a href="http://twitter.com/sunilkumar_g56"><img src="http://i835.photobucket.com/albums/zz277/sunilkumargec56/twitter_zps447bd274.jpg" width="40" height="40"></a>
</h1>

</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Sunil Kumar -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'techscribblings';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44991607-1', 'sunilnkumar.com');
    ga('send', 'pageview');
  </script>
</body>

</html>
